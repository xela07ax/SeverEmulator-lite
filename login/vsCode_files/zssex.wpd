zk.load('zss',function(){if(zk._p=zkpi('zssex'))try{
/*
 CLEditor WYSIWYG HTML Editor v1.4.5
 http://premiumsoftware.net/CLEditor
 requires jQuery v1.4.2 or later

 Copyright 2010, Chris Landowski, Premium Software, LLC
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(F){F.cleditor={defaultOptions:{width:"auto",height:250,controls:"bold italic underline strikethrough subscript superscript | font size style | color highlight removeformat | bullets numbering | outdent indent | alignleft center alignright justify | undo redo | rule image link unlink | cut copy paste pastetext | print source",colors:"FFF FCC FC9 FF9 FFC 9F9 9FF CFF CCF FCF CCC F66 F96 FF6 FF3 6F9 3FF 6FF 99F F9F BBB F00 F90 FC6 FF0 3F3 6CC 3CF 66C C6C 999 C00 F60 FC3 FC0 3C0 0CC 36F 63F C3C 666 900 C60 C93 990 090 399 33F 60C 939 333 600 930 963 660 060 366 009 339 636 000 300 630 633 330 030 033 006 309 303",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Narrow,Garamond,Georgia,Impact,Sans Serif,Serif,Tahoma,Trebuchet MS,Verdana",sizes:"1,2,3,4,5,6,7",styles:[["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],useCSS:true,docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',docCSSFile:"",bodyStyle:"margin:4px; font:10pt Arial,Verdana; cursor:text"},buttons:{init:"bold,,|italic,,|underline,,|strikethrough,,|subscript,,|superscript,,|font,,fontname,|size,Font Size,fontsize,|style,,formatblock,|color,Font Color,forecolor,|highlight,Text Highlight Color,hilitecolor,color|removeformat,Remove Formatting,|bullets,,insertunorderedlist|numbering,,insertorderedlist|outdent,,|indent,,|alignleft,Align Text Left,justifyleft|center,,justifycenter|alignright,Align Text Right,justifyright|justify,,justifyfull|undo,,|redo,,|rule,Insert Horizontal Rule,inserthorizontalrule|image,Insert Image,insertimage,url|link,Insert Hyperlink,createlink,url|unlink,Remove Hyperlink,|cut,,|copy,,|paste,,|pastetext,Paste as Text,inserthtml,|print,,|source,Show Source"},imagesPath:function(){return w()}};F.fn.cleditor=function(am){var al=F([]);this.each(function(an,ao){if(ao.tagName.toUpperCase()==="TEXTAREA"){var ap=F.data(ao,d);if(!ap){ap=new cleditor(ao,am)}al=al.add(ap)}});return al};var q="backgroundColor",g="blurred",af="button",ae="buttonName",D="change",d="cleditor",V="click",C="disabled",G="<div>",M="focused",z="transparent",R="unselectable",b="cleditorMain",x="cleditorToolbar",ag="cleditorGroup",Q="cleditorButton",ah="cleditorDisabled",O="cleditorDivider",K="cleditorPopup",aj="cleditorList",aa="cleditorColor",c="cleditorPrompt",ac="cleditorMsg",X=navigator.userAgent.toLowerCase(),L=/msie/.test(X),u=/msie\s6/.test(X),H=/(trident)(?:.*rv:([\w.]+))?/.test(X),l=/webkit/.test(X),o=/iPhone|iPad|iPod/i.test(X),i={},E,y=F.cleditor.buttons;F.each(y.init.split("|"),function(al,ao){var am=ao.split(","),an=am[0];y[an]={stripIndex:al,name:an,title:am[1]===""?an.charAt(0).toUpperCase()+an.substr(1):am[1],command:am[2]===""?an:am[2],popupName:am[3]===""?an:am[3]}});delete y.init;cleditor=function(aq,an){var ap=this;ap.options=an=F.extend({},F.cleditor.defaultOptions,an);var al=ap.$area=F(aq).css({border:"none",margin:0,padding:0}).hide().data(d,ap).blur(function(){S(ap,true)});var ar=ap.$main=F(G).addClass(b).width(an.width).height(an.height);var am=ap.$toolbar=F(G).addClass(x).appendTo(ar);var ao=F(G).addClass(ag).appendTo(am);var at=0;F.each(an.controls.split(" "),function(av,au){if(au===""){return true}if(au==="|"){var ax=F(G).addClass(O).appendTo(ao);ao.width(at+1);at=0;ao=F(G).addClass(ag).appendTo(am)}else{var ay=y[au];var aw=F(G).data(ae,ay.name).addClass(Q).attr("title",ay.title).bind(V,F.proxy(f,ap)).appendTo(ao).hover(ad,h);at+=24;ao.width(at+1);var az={};if(ay.css){az=ay.css}else{if(ay.image){az.backgroundImage=I(ay.image)}}if(ay.stripIndex){az.backgroundPosition=ay.stripIndex*-24}aw.css(az);if(L){aw.attr(R,"on")}if(ay.popupName){s(ay.popupName,an,ay.popupClass,ay.popupContent,ay.popupHover)}}});ar.insertBefore(al).append(al);if(!E){F(document).click(function(av){var au=F(av.target);if(!au.add(au.parents()).is("."+c)){ak()}});E=true}if(/auto|%/.test(""+an.width+an.height)){F(window).bind("resize.cleditor",function(){ai(ap)})}ai(ap)};var A=cleditor.prototype,J=[["clear",N],["disable",k],["execCommand",a],["focus",W],["hidePopups",ak],["sourceMode",j,true],["refresh",ai],["select",Y],["selectedHTML",p,true],["selectedText",T,true],["showMessage",B],["updateFrame",S],["updateTextArea",P]];F.each(J,function(al,am){A[am[0]]=function(){var aq=this,ap=[aq];for(var ao=0;ao<arguments.length;ao++){ap.push(arguments[ao])}var an=am[1].apply(aq,ap);if(am[2]){return an}return aq}});A.blurred=function(al){var am=F(this);return al?am.bind(g,al):am.trigger(g)};A.change=function e(al){var am=F(this);return al?am.bind(D,al):am.trigger(D)};A.focused=function(al){var am=F(this);return al?am.bind(M,al):am.trigger(M)};function f(aq){var ap=this,at=aq.target,au=F.data(at,ae),ao=y[au],ar=ao.popupName,am=i[ar];if(ap.disabled||F(at).attr(C)===C){return}var an={editor:ap,button:at,buttonName:au,popup:am,popupName:ar,command:ao.command,useCSS:ap.options.useCSS};if(ao.buttonClick&&ao.buttonClick(aq,an)===false){return false}if(au==="source"){if(j(ap)){delete ap.range;ap.$area.hide();ap.$frame.show();at.title=ao.title}else{ap.$frame.hide();ap.$area.show();at.title="Show Rich Text"}}else{if(!j(ap)){if(ar){var al=F(am);if(ar==="url"){if(au==="link"&&T(ap)===""){B(ap,"A selection is required when inserting a link.",at);return false}al.children(":button").unbind(V).bind(V,function(){var aw=al.find(":text"),av=F.trim(aw.val());if(av!==""){a(ap,an.command,av,null,an.button)}aw.val("http://");ak();W(ap)})}else{if(ar==="pastetext"){al.children(":button").unbind(V).bind(V,function(){var aw=al.find("textarea"),av=aw.val().replace(/\n/g,"<br />");if(av!==""){a(ap,an.command,av,null,an.button)}aw.val("");ak();W(ap)})}}if(au==="color"){ak();ap.wgt.openColorPopup();return false}if(at!==F.data(am,af)){n(ap,am,at);return false}return}else{if(au==="print"){ap.$frame[0].contentWindow.print()}else{if(!a(ap,an.command,an.value,an.useCSS,at)){return false}}}}}W(ap)}function ad(am){var al=F(am.target).closest("div");al.css(q,al.data(ae)?"#FFF":"#FFC")}function h(al){F(al.target).closest("div").css(q,"transparent")}function Z(ar){var ap=this,al=ar.data.popup,at=ar.target;if(al===i.msg||F(al).hasClass(c)){return}var av=F.data(al,af),aw=F.data(av,ae),ao=y[aw],am=ao.command,au,aq=ap.options.useCSS;if(aw==="font"){au=at.style.fontFamily.replace(/"/g,"")}else{if(aw==="size"){if(at.tagName.toUpperCase()==="DIV"){at=at.children[0]}au=at.innerHTML}else{if(aw==="style"){au="<"+at.tagName+">"}else{if(aw==="color"){au=U(at.style.backgroundColor)}else{if(aw==="highlight"){au=U(at.style.backgroundColor);if(L){am="backcolor"}else{aq=true}}}}}}var an={editor:ap,button:av,buttonName:aw,popup:al,popupName:ao.popupName,command:am,value:au,useCSS:aq};if(ao.popupClick&&ao.popupClick(ar,an)===false){return}if(an.command&&!a(ap,an.command,an.value,an.useCSS,av)){return false}ak();W(ap)}function t(ao){var am=1,al=0;for(var an=0;an<ao.length;++an){am=(am+ao.charCodeAt(an))%65521;al=(al+am)%65521}return(al<<16)|am}function N(al){al.$area.val("");S(al)}function s(ap,an,ao,am,aq){if(i[ap]){return i[ap]}var ar=F(G).hide().addClass(K).appendTo("body");if(am){ar.html(am)}else{if(ap==="color"){var al=an.colors.split(" ");if(al.length<10){ar.width("auto")}F.each(al,function(at,au){F(G).appendTo(ar).css(q,"#"+au)});ao=aa}else{if(ap==="font"){F.each(an.fonts.split(","),function(at,au){F(G).appendTo(ar).css("fontFamily",au).html(au)})}else{if(ap==="size"){F.each(an.sizes.split(","),function(at,au){F(G).appendTo(ar).html("<font>"+au+"</font>")})}else{if(ap==="style"){F.each(an.styles,function(at,au){F(G).appendTo(ar).html(au[1]+au[0]+au[1].replace("<","</"))})}else{if(ap==="url"){ar.html('<label>Enter URL:<br /><input type="text" value="http://" style="width:200px" /></label><br /><input type="button" value="Submit" />');ao=c}else{if(ap==="pastetext"){ar.html('<label>Paste your content here:<br /><textarea rows="3" style="width:200px"></textarea></label><br /><input type="button" value="Submit" />');ao=c}}}}}}}if(!ao&&!am){ao=aj}ar.addClass(ao);if(L){ar.attr(R,"on").find("div,font,p,h1,h2,h3,h4,h5,h6").attr(R,"on")}if(ar.hasClass(aj)||aq===true){ar.children().hover(ad,h)}i[ap]=ar[0];return ar[0]}function k(am,al){if(al){am.$area.attr(C,C);am.disabled=true}else{am.$area.removeAttr(C);delete am.disabled}try{if(L){am.doc.body.contentEditable=!al}else{am.doc.designMode=!al?"on":"off"}}catch(an){}r(am)}function a(aq,an,at,ar,ao){ab(aq);if(!L){if(ar===undefined||ar===null){ar=aq.options.useCSS}aq.doc.execCommand("styleWithCSS",0,ar.toString())}var al=an.toLowerCase()==="inserthtml";if(L&&al){m(aq).pasteHTML(at)}else{if(H&&al){var au=v(aq),ap=au.getRangeAt(0);ap.deleteContents();ap.insertNode(ap.createContextualFragment(at));au.removeAllRanges();au.addRange(ap)}else{var av=true,aw;try{av=aq.doc.execCommand(an,0,at||null)}catch(am){aw=am.message;av=false}if(!av){if("cutcopypaste".indexOf(an)>-1){B(aq,"For security reasons, your browser does not support the "+an+" command. Try using the keyboard shortcut or context menu instead.",ao)}else{B(aq,(aw?aw:"Error executing the "+an+" command."),ao)}}}}F(aq.doc).find("font").each(function(){var az=F("<span></span>").html(this.innerHTML),aA=az[0];if(this.hasAttribute("size")){az.css("font-size",at+"pt")}if(this.hasAttribute("face")){az.css("font-family",this.getAttribute("face"))}if(this.hasAttribute("color")){az.css("color",this.getAttribute("color"))}F(this).replaceWith(az);var ay=v(aq),ax=m(aq);if(L){ax.moveToElementText(aA);ax.select()}else{ax.selectNode(aA);ay.removeAllRanges();ay.addRange(ax)}});r(aq);P(aq,true);return av}function W(al){setTimeout(function(){if(j(al)){al.$area.focus()}else{al.$frame[0].contentWindow.focus()}r(al)},0)}function m(al){if(L){return v(al).createRange()}return v(al).getRangeAt(0)}function v(al){if(L){return al.doc.selection}return al.$frame[0].contentWindow.getSelection()}function U(am){var al=/rgba?\((\d+), (\d+), (\d+)/.exec(am);if(al){am=(al[1]<<16|al[2]<<8|al[3]).toString(16);while(am.length<6){am="0"+am}return"#"+am}var an=am.split("");if(am.length===4){return"#"+an[1]+an[1]+an[2]+an[2]+an[3]+an[3]}return am}function ak(){F.each(i,function(al,am){F(am).hide().unbind(V).removeData(af)})}function w(){var al=F("link[href*=cleditor]").attr("href");return al.replace(/^(.*\/)[^\/]+$/,"$1")+"images/"}function I(al){return"url("+w()+al+")"}function ai(an){var ap=an.$main,am=an.options;if(an.$frame){an.$frame.remove()}var ao=an.$frame=F('<iframe frameborder="0" src="javascript:true;" />').hide().appendTo(ap);var al=ao[0].contentWindow,aq=an.doc=al.document,ar=F(aq);aq.open();aq.write(am.docType+"<html>"+((am.docCSSFile==="")?"":'<head><link rel="stylesheet" type="text/css" href="'+am.docCSSFile+'" /></head>')+'<body style="'+am.bodyStyle+'"></body></html>');aq.close();if(L||H){ar.click(function(){W(an)})}S(an);if(L||H){ar.bind("beforedeactivate beforeactivate selectionchange keypress keyup",function(at){if(at.type==="beforedeactivate"){an.inactive=true}else{if(at.type==="beforeactivate"){if(!an.inactive&&an.range&&an.range.length>1){an.range.shift()}delete an.inactive}else{if(!an.inactive){if(!an.range){an.range=[]}an.range.unshift(m(an));while(an.range.length>2){an.range.pop()}}}}});ao.focus(function(){ab(an);F(an).triggerHandler(M)});ao.blur(function(){F(an).triggerHandler(g)})}else{F(ao[0].contentWindow).focus(function(){F(an).triggerHandler(M)}).blur(function(){F(an).triggerHandler(g)})}ar.click(ak).keydown(function(at){if(L&&v(an).type=="Control"&&at.keyCode==8){v(an).clear();at.preventDefault()}}).bind("keyup mouseup",function(){r(an);P(an,true)});if(o){an.$area.show()}else{ao.show()}F(function(){var au=an.$toolbar,av=au.children("div:last"),aw=ap.width();var at=av.offset().top+av.outerHeight()-au.offset().top+1;au.height(at);at=(/%/.test(""+am.height)?ap.height():parseInt(am.height,10))-at;ao.width(aw).height(at);an.$area.width(aw).height(u?at-2:at);k(an,an.disabled);r(an)})}function r(al){if(!o&&l&&!al.focused){al.$frame[0].contentWindow.focus();window.focus();al.focused=true}var am=al.doc;if(L){am=m(al)}var an=j(al);F.each(al.$toolbar.find("."+Q),function(ao,au){var ap=F(au),ar=F.cleditor.buttons[F.data(au,ae)],aw=ar.command,aq=true;if(al.disabled){aq=false}else{if(ar.getEnabled){var av={editor:al,button:au,buttonName:ar.name,popup:i[ar.popupName],popupName:ar.popupName,command:ar.command,useCSS:al.options.useCSS};aq=ar.getEnabled(av);if(aq===undefined){aq=true}}else{if(((an||o)&&ar.name!=="source")||(L&&(aw==="undo"||aw==="redo"))){aq=false}else{if(aw&&aw!=="print"){if(L&&aw==="hilitecolor"){aw="backcolor"}if((!L&&!H)||aw!=="inserthtml"){try{aq=am.queryCommandEnabled(aw)}catch(at){aq=false}}}}}}if(aq){ap.removeClass(ah);ap.removeAttr(C)}else{ap.addClass(ah);ap.attr(C,C)}})}function ab(al){if(al.range){if(L){al.range[0].select()}else{if(H){v(al).addRange(al.range[0])}}}}function Y(al){setTimeout(function(){if(j(al)){al.$area.select()}else{a(al,"selectall")}},0)}function p(ao){ab(ao);var al=m(ao);if(L){return al.htmlText}var an=F("<layer>")[0];an.appendChild(al.cloneContents());var am=an.innerHTML;an=null;return am}function T(al){ab(al);if(L){return m(al).text}return v(al).toString()}function B(an,ao,am){var al=s("msg",an.options,ac);al.innerHTML=ao;n(an,al,am)}function n(at,an,ar){var aq,ap,au,al=F(an);if(ar){var am=F(ar);aq=am.offset();ap=--aq.left;au=aq.top+am.height()}else{var ao=at.$toolbar;aq=ao.offset();ap=Math.floor((ao.width()-al.width())/2)+aq.left;au=aq.top+ao.height()-2}ak();al.css({left:ap,top:au}).show();if(ar){F.data(an,af,ar);al.bind(V,{popup:an},F.proxy(Z,at))}setTimeout(function(){al.find(":text,textarea").eq(0).focus().select()},100)}function j(al){return al.$area.is(":visible")}function S(ap,al){if(!ap.doc){return}var aq=ap.$area.val(),am=ap.options,at=am.updateFrame,ar=F(ap.doc.body);if(at){var ao=t(aq);if(al&&ap.areaChecksum===ao){return}ap.areaChecksum=ao}var an=at?at(aq):aq;an=an.replace(/<(?=\/?script)/ig,"&lt;");if(am.updateTextArea){ap.frameChecksum=t(an)}if(an!==ar.html()){ar.html(an);F(ap).triggerHandler(D)}}function P(aq,al){var ao=F(aq.doc.body).html(),an=aq.options,at=an.updateTextArea,am=aq.$area;if(at){var ap=t(ao);if(al&&aq.frameChecksum===ap){return}aq.frameChecksum=ap}var ar=at?at(ao):ao;if(an.updateFrame){aq.areaChecksum=t(ar)}if(ar!==am.val()){am.val(ar);F(aq).triggerHandler(D)}}})(jQuery);
zssex.Ghost=zk.$extends(zk.Widget,{ghost:true,domClass_:function(a){return"zssexghost"},getPosition:zk.$void});
zkreg('zssex.Ghost');
zk._m={};
zk._m['default']=function(b){b.push("<div",this.domAttrs_(),' style="display:none">');for(var a=this.firstChild;a;a=a.nextSibling){a.redraw(b)}b.push("</div>")};
;zkmld(zk._p.p.Ghost,zk._m);
(function(){function g(m,o,r){var t=m.control,p=m.opts.type=t._dragType,l=t._focusBorderSize,n=r.domTarget,q=jq(m.node),j=q.width()-l*2+2,s=q.height()-l*2+2,i=jq('<div id="zk_ddghost"></div>').attr("style",q.attr("style")).addClass("zswidget zswidget-drag z-drag-ghost").width(j+"px").height(s+"px");m._orgcursor=document.body.style.cursor;document.body.style.cursor=p=="resize"?"crosshair":"move";if("move"==p){i.appendTo(t._sheet.comp);var k=zk(m.node).revisedOffset();m.opts.innerOffset=[r.pageX-k[0]+l,r.pageY-k[1]+l];document.body.style.cursor="move"}else{var h=t._panel;if(h=="top"){i.appendTo(t._sheet.tp.$n("topwp"))}else{if(h=="left"){i.appendTo(t._sheet.lp.$n("leftwp"))}else{if(h=="corner"){i.appendTo(t._sheet.cp.$n("cornerwp"))}else{i.appendTo(t._sheet.sp.comp)}}}document.body.style.cursor="crosshair"}jq(t.getDragNode()).addClass("z-dragged");return i[0]}function b(m,l,i){var k=i-m[0],h=l.offsetLeft+l.clientHeight-20;if(k>h){k=h}var j=l.offsetLeft+l.clientWidth-k;return[k,j]}function e(m,j,i){var h=i-m[1],l=j.offsetTop+j.clientHeight-20;if(h>l){h=l}var k=j.offsetTop+j.clientHeight-h;return[h,k]}function d(k,j,h){var i=20;return Math.max(i,h-k[1])}function c(k,j,i){var h=20;return Math.max(h,i-k[0])}function f(I,C,z){var q=I.control,F=q.getDragNode(),D=I.node,k=q._dragType,B=q._dragDir,u=q._focusBorderSize,v=I.opts;if("resize"==k&&B){var o=I.control._sheet,r=o.sp.comp,A=q._focus;if("N"==B){var E=zk(r).revisedOffset(),H=zk(F).revisedOffset(),h=r.scrollTop,i=e(E,F,z.pageY+h),w=i[0],m=i[1];jq(D).height(m+"px");v.x1=H[0]+u;v.x2=v.x1+F.clientWidth-(u*2);v.y1=w+E[1]-h;v.y2=v.y1+m-u;return[D.offsetLeft,w]}else{if("NE"==B){var E=zk(r).revisedOffset(),H=zk(F).revisedOffset(),l=D.offsetLeft,h=r.scrollTop,i=e(E,F,z.pageY+h),w=i[0],m=i[1],t=c(zk(D).revisedOffset(),F,z.pageX);jq(D).height(m+"px").width(t+"px");v.x1=H[0]+u;v.x2=v.x1+t-4;v.y1=w+E[1]-h;v.y2=v.y1+m-u;return[l,w]}else{if("E"==B){var E=zk(D).revisedOffset(),H=zk(F).revisedOffset(),l=D.offsetLeft,w=D.offsetTop,t=c(E,F,z.pageX);jq(D).width(t+"px");v.x1=H[0]+u;v.y1=H[1]+u;v.x2=v.x1+t-4;v.y2=v.y1+F.clientHeight-(u*2);return[l,w]}else{if("SE"==B){var E=zk(D).revisedOffset(),H=zk(F).revisedOffset(),l=D.offsetLeft,w=D.offsetTop,t=c(E,F,z.pageX),m=d(E,F,z.pageY);jq(D).width(t+"px").height(m+"px");v.x1=H[0]+u;v.y1=H[1]+u;v.x2=v.x1+t-4;v.y2=v.y1+m-4;return[l,w]}else{if("S"==B){var E=zk(D).revisedOffset(),H=zk(F).revisedOffset(),l=D.offsetLeft,w=D.offsetTop,m=d(E,F,z.pageY);jq(D).height(m+"px");v.x1=H[0]+u;v.y1=H[1]+u;v.x2=v.x1+F.clientWidth-(u*2);v.y2=v.y1+m-4;return[l,w]}else{if("SW"==B){var E=zk(r).revisedOffset(),H=zk(F).revisedOffset(),m=d(zk(D).revisedOffset(),F,z.pageY),G=r.scrollLeft,L=b(E,F,z.pageX+G),l=L[0],t=L[1];jq(D).width(t+"px").height(m+"px");v.x1=l+E[0]-G;v.y1=H[1]+u;v.x2=v.x1+t-4;v.y2=v.y1+m-4;return[l,F.offsetTop]}else{if("W"==B){var E=zk(r).revisedOffset(),H=zk(F).revisedOffset(),G=r.scrollLeft,L=b(E,F,z.pageX+G),w=F.offsetTop,l=L[0],t=L[1];jq(D).width(t+"px");v.x1=l+E[0]-G;v.y1=H[1]+u;v.x2=v.x1+t-4;v.y2=v.y1+F.clientHeight-(u*2);return[l,w]}else{if("NW"==B){var E=zk(r).revisedOffset(),H=zk(F).revisedOffset(),G=r.scrollLeft,L=b(E,F,z.pageX+G),h=r.scrollTop,i=e(E,F,z.pageY+h),w=i[0],m=i[1],l=L[0],t=L[1];jq(D).width(t+"px").height(m+"px");v.x1=l+E[0]-G;v.y1=w+E[1]-h;v.x2=v.x1+t-4;v.y2=v.y1+m-u;return[l,w]}}}}}}}}}else{var j=I.opts.innerOffset,j=!j?[0,0]:j,o=I.control._sheet,E=zk(o.comp).revisedOffset(),K=o.leftWidth,J=o.topHeight,s=Math.max(z.pageX-E[0]-j[0],K),p=Math.max(z.pageY-E[1]-j[1],J);v.x1=s;v.x2=v.x1+F.clientWidth-(u*2)+1;v.y1=p;v.y2=v.y1+F.clientHeight-(u*2)+1;return[s,p]}}function a(A,x){var s=A.control,w=A.opts,o=A.control._sheet,y=zk(o.dp.comp).revisedOffset(),m=s._dragType;if("resize"!=m){w.x1+=y[0];w.x2+=y[0];w.y1+=y[1];w.y2+=y[1]}var v=s._panel,F=o.sheetid,G=o.leftWidth,i=o.topHeight,r=A.node.firstChild,n=o.custColWidth,p=o.custRowHeight,E=zss.SSheetCtrl._calCellPos(o,w.x1,w.y1,m=="resize"&&v=="default"),C=zss.SSheetCtrl._calCellPos(o,w.x2,w.y2,m=="resize"&&v=="default"),j=n.getStartPixel(E[1]),q=p.getStartPixel(E[0]),h=n.getStartPixel(C[1]),D=p.getStartPixel(C[0]),l=w.x1-y[0]-G-j,u=w.y1-y[1]-i-q,z=C[1]==E[1],B=C[0]==E[0],k=z?l+(w.x2-w.x1):w.x2-y[0]-G-h,t=B?u+(w.y2-w.y1):w.y2-y[1]-i-D;s._sheet._wgt.fireWidgetUpdatEvt(s.getType(),A.opts.type,A.control.getId(),Math.round(l),Math.round(u),Math.round(k),Math.round(t),E[1],E[0],C[1],C[0]);A.control._dragging=false;zcss.removeRule("#"+F+" .zswidget-focus",F+"-sheet")}zssex.Widget=zk.$extends(zul.Widget,{_leftPos:null,_topPos:null,_dragging:false,_delaySetDragMove:null,_dragType:null,_dragDir:null,_focus:false,_focusBorderSize:6,$define:{col:function(){this.adjustLocation()},row:function(){this.adjustLocation()},left:function(){this.adjustLocation()},top:function(){this.adjustLocation()},visible:function(h){var i=this.$n();if(i){jq(i).css("visibility",h?"visible":"hidden")}},sizable:_zkf=function(){this.updateDraggable_()},movable:_zkf,id:null,type:null,panel:null},insertChildHTML_:function(j,h,i){if(h){jq(h).before(j.redrawHTML_())}else{jq(this.$n("real")).append(j.redrawHTML_())}j.bind(i)},adjustLocation:function(s){var i=this.$n(),p=this._sheet;if(!i||!p){return}var j=this.getCol(),t=this.getRow(),q=p.custColWidth,u=p.custRowHeight,m=q.getSize(j),h=u.getSize(t),k=this._leftPos=p.leftWidth+q.getStartPixel(j)+(this.getLeft()>m?m:this.getLeft()),r=this._topPos=p.topHeight+u.getStartPixel(t)+(this.getTop()>h?h:this.getTop()),o=this._focus,l=this._focusBorderSize;jq(i).css({left:o?jq.px(k-l):jq.px(k),top:o?jq.px(r-l):jq.px(r)});if(s){jq(i).css("visibility","visible")}},_cloneAttrs:function(h){if(h._id==this._id){h._sheet=this._sheet;h._leftPos=this._leftPos;h._topPos=this._topPos}},redrawWidgetTo:function(i){if(!i){return}this._sheet=i;var h=this._panel;var j;if(h=="top"){j=i.tp.$n("topwp")}else{if(h=="left"){j=i.lp.$n("leftwp")}else{if(h=="corner"){j=i.cp.$n("cornerwp")}else{j=i.$n("wp")}}}jq(j).append(this.$n());this.clearCache();this.adjustLocation(true);this.updateDraggable_()},updateDraggable_:function(){this.setDraggable(this.isSizable()||this.isMovable())},getDragOptions_:function(h){h.ghosting=g;h.constraint=f;h.endeffect=a;return h},ignoreDrag_:function(j){var h=this._sheet;var i=!this._dragType||(h.state==zss.SSheetCtrl.NOFOCUS&&!this._focus)||!this.isEditable();if(!i&&!this._focus){this._gainFocus()}this._dragging=!i;return i},doBlur_:function(h){jq(this.$n()).removeClass("zswidget-focus").css({left:jq.px(this._leftPos),top:jq.px(this._topPos)});this._updateListenFocus(false)},_onSheetFocus:function(h){var i=h.data;if(i){if(i.ctrl!=this){this.doBlur_()}}else{this.doBlur_()}},doMouseMove_:function(p){if(!this.isEditable()){return}if(!this._dragging){var C=p.domTarget,t=this.$n(),D=this._sheet.sheetid,o=D+"-sheet",z="#"+D;if((C==t||C==this.$n("cave"))&&this.isSizable()){this._dragType="resize";var u=zk(t).revisedOffset(),q=this._focusBorderSize,l=p.pageX-u[0],j=p.pageY-u[1],m=t.clientWidth,v=t.clientHeight,r=q,A=m-q,k=q,i=v-q,s;if(l<=r&&j<=k){s="NW"}else{if(l<=r&&j<=i){s="W"}else{if(l<=r&&j>i){s="SW"}else{if(l<=A&&j<=k){s="N"}else{if(l>A&&j<=k){s="NE"}else{if(l>A&&j<=i){s="E"}else{if(l<=A&&j>i){s="S"}else{if(this._dragDir!="ES"){s="SE"}}}}}}}}if(s!=this._dragDir){this._dragDir=s;zcss.setRule(z+" .zswidget-focus","cursor",s.toLowerCase()+"-resize",true,o)}this._delaySetDragMove=jq.now()}else{if(jq.isAncestor(this.$n("real"),C)){this._dragDir=null;var B=this._delaySetDragMove;if(!B||(B&&(jq.now()-B)>500)){this._delaySetDragMove=null;if(this._dragType!="move"){this._dragType="move";zcss.setRule(z+" .zswidget-focus","cursor","move",null,o)}}}}}},doMouseDown_:function(h){if(!this.isEditable()){return}if(jq.isAncestor(this.$n("real"),h.domTarget)){this._delaySetDragMove=null}if(!this._focus){var i=this._sheet,j=i.state;if(j==zss.SSheetCtrl.EDITING){i.dp.stopEditing()}else{if(j==zss.SSheetCtrl.NOFOCUS){i.dp.gainFocus();return}}this._gainFocus()}},doMouseUp_:function(h){this._dragging=false},isEditable:function(){var h=this._sheet._wgt;return !h.isProtect()||h.objectEditable},_gainFocus:function(){var i=this._sheet,j=jq(this.$n()),h=this._focusBorderSize,l=this._leftPos-h,k=this._topPos-h;j.addClass("zswidget-focus");if(l>0){j.css({left:jq.px(l)})}if(k>0){j.css({top:jq.px(k)})}i.fire("onFocused",{ctrl:this});this._updateListenFocus(true)},afterKeyDown_:function(h){var i=h.data;i.wgt=true;i.wgtType=this._type;i.wgtId=this._id;i.sheetId=this._sheet._wgt.getSheetId();this.$supers("afterKeyDown_",arguments)},_updateListenFocus:function(h){var i=this._focus;if(i!=h){this._sheet[i?"unlisten":"listen"]({onFocused:this.proxy(this._onSheetFocus)});this._focus=h;this.$n("fo")[h?"focus":"blur"]()}},bind_:function(){this.$supers("bind_",arguments)},unbind_:function(){this._updateListenFocus(false);this.$supers("unbind_",arguments)},domClass_:function(h){return"zswidget"}})})();
zkreg('zssex.Widget');
zk._m={};
zk._m['default']=function(b){var c=this.uuid;b.push("<div",this.domAttrs_(),'><a id="',this.uuid,'-fo" href="javascript:" class="zswidget-ifocus"></a><div id="',c,'-cave" class="zswidget-cave"><div id="',c,'-real" class="zswidget-real">');for(var a=this.firstChild;a;a=a.nextSibling){a.redraw(b)}b.push("</div></div></div>")};
;zkmld(zk._p.p.Widget,zk._m);
zssex.Btn=zk.$extends(zul.wgt.Div,{$init:function(g,a,e,h,i,f,j,b){this.$supers(zssex.Btn,"$init",[]);this.sheet=g;this.loffset=b?g.custColWidth.getStartPixel(b):0;this.row=a;this.col=e;this.field=f;this.btntype=j;this.uuid=zk.Widget.nextUuid();var d='<div id="'+this.uuid+'" zs.t="SBtn" class="zsbtn '+i+'"></div>';this._zclass="zsbtn";this._sclass=i;jq(h).append(d);this.replaceHTML(d);this.relocate(a,e)},cleanup:function(){var a=this.$n();this.unbind();if(a){jq(a).remove()}},doTooltipOver_:function(){},doTooltipOut_:function(){},doClick_:function(a){},doMouseDown_:function(a){if((a.which)&&(a.which==1)){this.sheet._doBtndown(a,this.btntype,a.domTarget,this)}},doMouseUp_:function(a){this.sheet._doMouseup(a)},doRightClick_:function(a){this.sheet._doMouserightclick(a)},doDoubleClick_:function(a){this.sheet._doMousedblclick(a)},doKeyDown_:function(a){this.sheet.doKeyDown_(a)},afterKeyDown_:function(a){this.sheet._wgt.afterKeyDown_(a)},doKeyPress_:function(a){this.sheet._doKeypress(a)},relocate:function(p,b){var j=this.sheet;this.row=p;this.col=b;var a=b;var m=j.getCell(p,b);if(m&&m.merr&&m.merr>a){a=m.merr}var g=j.custColWidth,q=j.custRowHeight,d=g.getStartPixel(b),o=q.getStartPixel(p),k=g.getStartPixel(a+1)-d,e=q.getStartPixel(p+1)-o,c=17,n=17,f=c,i=n;if(k<c){c=k;i=k}if(e<n){n=e;f=e}if(i<n){n=i}if(f<c){c=f}this.relocate_(d-this.loffset+k-(this.btntype=="af"?c:-1),o+e-n,c,n)},relocate_:function(b,c,a,d){this.imgwidth=a;this.imgheight=d;this.imgleft=b-1;this.imgtop=c-2;jq(this.$n()).css({width:jq.px0(a),height:jq.px0(d),left:jq.px(this.imgleft)});if(zk.ie6_){jq(this.$n()).css({top:jq.px(this.imgtop)})}}});
zkreg('zssex.Btn');
(function(){function j(u,x,v){var p=u.getCell(x,v),E=v,D=v,B=x,H=x;if(p){if(p.merl&&p.merl<E){E=p.merl}if(p.merr&&p.merr>D){D=p.merr}if(p.mert&&p.mert<B){B=p.mert}if(p.merb&&p.merb>H){H=p.merb}}var o=u.topHeight;var I=u.leftWidth;var q=u.custColWidth;var y=u.custRowHeight;var s=q.getStartPixel(E);var C=y.getStartPixel(B);var G=q.getStartPixel(D+1)-1;var z=y.getStartPixel(H+1)-1;if(B>u.frozenRow){C-=u.spcmp.scrollTop}if(H>u.frozenRow){z-=u.spcmp.scrollTop}if(E>u.frozenCol){s-=u.spcmp.scrollLeft}if(D>u.frozenCol){G-=u.spcmp.scrollLeft}var A=G-s+1;var F=z-C+1;return{top:C+o,left:s+I,bottom:z+o,right:G+I,width:A,height:F}}zssex.Popup=zk.$extends(zk.Widget,{$o:zk.$void,$init:function(o){this.$supers(zssex.Popup,"$init",[]);this.sheet=o},open:function(){},close:function(){this.setVisible(false)}});zssex.CellPopup=zk.$extends(zssex.Popup,{widgetName:"CellPopup",isOpen:function(){return this.$n()&&this.isVisible()},open:function(q,w){if(!this.isOpen()){var v=this.$n();if(!v){this.createPopup_()}var t=this.relocate(q,w);this.setVisible(true);var s=this.sheet.spcmp.offsetHeight,o=t.top,p=t.height,u=this._node.offsetHeight;if((o+p+u)>s){jq(this.$n()).css({top:jq.px(t.top-u)})}}},relocate:function(q,o){var p=j(this.sheet,q,o);jq(this.$n()).css({left:jq.px(p.left),top:jq.px(p.bottom),width:jq.px(p.width)});return p},createPopup_:function(){jq(this.sheet.$n()).append(this.redrawHTML_());this.clearCache();this.bind_()},redrawHTML_:function(){return this.prologHTML_()+this.contentHTML_()+this.epilogHTML_()},contentHTML_:function(){return""},prologHTML_:function(){return"<div "+this.domAttrs_()+">"},epilogHTML_:function(){return"</div>"},listenSheetFocused_:function(o){var p=!!this._listenSheetFocused;if(p!=o){this.sheet[o?"listen":"unlisten"]({onFocused:this.proxy(this.onSheetFocused)});this._listenSheetFocused=o}},onSheetFocused:function(o){},listenSheetBlur_:function(o){var p=!!this._listenSheetBlur;if(p!=o){this.sheet._wgt[o?"listen":"unlisten"]({onBlur:this.proxy(this.onSheetBlur)});this._listenSheetBlur=o}},onSheetBlur:function(o){},getZclass:function(){return"zscellpopup"}});zssex.ValidationPromptPopup=zk.$extends(zssex.CellPopup,{widgetName:"ValidationPromptPopup",$init:function(o,q,p){this.$supers(zssex.ValidationPopup,"$init",arguments);this._pos={};this._title=q;this._text=p},unbind_:function(){delete this._pos;this._title=this._text=null;this.listenSheetFocused_(false);this.$supers(zssex.ValidationPromptPopup,"unbind_",arguments)},open:function(p,q){if(!this.isOpen()){this.$supers(zssex.ValidationPromptPopup,"open",arguments);if(zk.ie6_||zk.ie7_||zk.opera){jq(this.$n()).addClass("zsdvp-popup")}var o=this;setTimeout(function(){o.listenSheetFocused_(true)})}},close:function(){var o=this;setTimeout(function(){o.listenSheetFocused_(false)});this.$supers(zssex.ValidationPromptPopup,"close",arguments)},relocate:function(x,p){var w=245,q=3,r=6,u=jq(this.$n());var t=this.sheet,o=j(this.sheet,x,p),v=this._pos;v.row=x;v.col=p;u.css({left:jq.px(o.right+q),top:jq.px(o.bottom+r)});if(!zk.ie6_&&!zk.ie7_){var s=zk.parseInt(u.width());if(s>w){u.width(jq.px(w))}}return o},onSheetFocused:function(o){var t=o.data,r=this._pos,q=t.col,s=t.row;if(r.row!=s||r.col!=q){this.close()}},contentHTML_:function(){var o=this.uuid,q=this._title,p=this._text;return'<div id="'+o+'-cave" class="zsdvp-popup-cave"><div id="'+o+'-title" class="zsdvp-title">'+(q?q:"")+'</div><div id="'+o+'-text" class="zsdvp-text">'+(p?p:"")+"</div></div>"}});function h(p){if(p.tagName.toLowerCase()=="a"){return p}var o=p.firstChild;return o&&o.tagName.toLowerCase()=="a"?o:null}function l(r,o,p){var q=p.state;p.state=zss.SSheetCtrl.FOCUSED;p.moveCellFocus(r,o,true);p.moveCellSelection(o,r,o,r,false,true);p.state=q}zssex.ValidationPopup=zk.$extends(zssex.CellPopup,{widgetName:"ValidationPopup",$init:function(o){this.$supers(zssex.ValidationPopup,"$init",arguments);this._pos={};this._validationList=[]},bind_:function(){this.$supers(zssex.ValidationPopup,"bind_",arguments);var o=this._validationList.length,p=this.$n();if(p){if(o>=8){jq(p).css({overflow:"auto",height:"155px"})}else{jq(p).css({overflow:"hidden",height:""})}}},unbind_:function(){delete this._pos;delete this._validationList;this.listenSheetBlur_(false);this.listenSheetFocused_(false);this.$supers(zssex.ValidationPopup,"unbind_",arguments)},_markSelectedItem:function(u,o){var q=this.sheet,s=q.getCell(u,o).getPureText(),r=this.$n("cave").firstChild;if(r){for(;r;r=r.nextSibling){var v=jq(r.firstChild),p=v.text();jq(r)[s==p?"addClass":"removeClass"]("zsdv-item-over")}}},open:function(o,p){if(this.isOpen()){this.close()}else{this.$supers(zssex.ValidationPopup,"open",arguments);this._markSelectedItem(o,p);this.listenSheetBlur_(true);this.listenSheetFocused_(true)}},close:function(){var o=this;setTimeout(function(){o.listenSheetBlur_(false);o.listenSheetFocused_(false);o.sheet.dp.gainFocus(false)});this.$supers(zssex.ValidationPopup,"close",arguments)},onSheetFocused:function(o){this.close()},relocate:function(u,o){var p=this.sheet,t=j(this.sheet,u,o),r=17,q=t.width+r,s=t.right+r-q,v=this._pos;v.row=u;v.col=o;jq(this.$n()).css({left:jq.px(s),top:jq.px(t.bottom),width:jq.px(q)});return t},setValidationList:function(r){var o=this._validationList,q=r.length,p=q;o.splice(0,o.length);while(p--){o[p]=r[p]}var s=this.$n();if(s){if(q>=8){jq(s).css({overflow:"auto",height:"155px"})}else{jq(s).css({overflow:"hidden",height:""})}}},contentHTML_:function(){var r=this.uuid,q='<ul id="'+r+'-cave" class="zsdv-popup-cave">',s=this._validationList,p=s.length;for(var o=0;o<p;o++){q+='<li class="zsdv-item"><a href="javascript:" class="zsdv-item-text">'+s[o]+"</a></li>"}q+='</ul><a id="'+r+'-fo" href="javascript:"></a>';return q},_editCell:function(t,o,s){var p=this.sheet,r=p.getCell(t,o).getPureText();if(r!=s){var q=p.state;if(p.state!=zss.SSheetCtrl.START_EDIT){p.state=zss.SSheetCtrl.START_EDIT;p._wgt.fire("onStartEditing",{token:"",sheetId:p.serverSheetId,row:t,col:o,clienttxt:s,type:"inlineEditing"},null,25)}p.state=q;p._wgt.fire("onStopEditing",{token:"",sheetId:p.serverSheetId,row:t,col:o,value:s,type:"inlineEditing"},{toServer:true},25)}},onSheetBlur:function(){if(this.isOpen()){var o=jq(this.$n()).find(".zsdv-item-over"),q=this._pos;row=q.row,col=q.col;if(o.length){jq(o[0].firstChild).focus()}else{jq(this.$n("fo")).focus()}l(q.row,q.col,this.sheet)}},doMouseOver_:_zkf=function(o){var p=h(o.domTarget);if(p){var q=jq(this.$n()).find(".zsdv-item-over");if(q.length){q.removeClass("zsdv-item-over")}jq(p.parentNode).addClass("zsdv-item-over")}},doMouseMove_:_zkf,doKeyPress_:function(o){},doMouseDown_:function(o){var r=h(o.domTarget);if(r){var q=this._pos;this._editCell(q.row,q.col,jq(r).text());this.close()}},doKeyDown_:function(r){var q=r.keyCode,t=document.activeElement==this.$n("fo"),v=null,s=null;switch(q){case 38:case 40:if(t){s=this.$n("cave").firstChild}else{v=jq(this.$n()).find(".zsdv-item-over");if(v.length){s=q==38?v[0].previousSibling:v[0].nextSibling}}if(s){jq(s).addClass("zsdv-item-over");jq(s.firstChild).focus()}if(s&&v){v.removeClass("zsdv-item-over")}break;case 13:var o=jq(this.$n()).find(".zsdv-item-over");if(o.length){var u=this._pos;this._editCell(u.row,u.col,jq(o[0]).text())}this.close();break;case 27:this.close();break}r.stop()}});function m(p){var o=jq(p);return o.hasClass("zsafp-item")?o[0]:o.hasClass("zsafp-item-checkbox")||(zk.ie6_&&o.hasClass("zsafp-item-text"))?o[0].parentNode:null}function i(r){if(r==null){return}var q=r.parentNode,o=q.firstChild;for(;o;o=o.nextSibling){if(o!=r){jq(o).removeClass("zsafp-item-over")}}jq(r).addClass("zsafp-item-over")}function n(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-ccitem")?p[0]:o.hasClass("zsafp-ccitem")?o[0]:null}function a(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-fcitem")?p[0]:o.hasClass("zsafp-fcitem")?o[0]:null}function g(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-color")?p[0]:o.hasClass("zsafp-color")?o[0]:null}function c(p){var o=jq(p);if(o!=null){jq(o).css("display","inline-block")}}function f(p){var o=jq(p);if(o!=null){jq(o).css("display","none")}}function b(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-vitem")?p[0]:o.hasClass("zsafp-vitem")?o[0]:null}function e(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-value")?p[0]:o.hasClass("zsafp-value")?o[0]:null}function k(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-clear")&&!p.hasClass("zsafp-clear-disabled")?p[0]:o.hasClass("zsafp-clear")&&!o.hasClass("zsafp-clear-disabled")?o[0]:null}function d(q){var p=jq(q);var o=jq(q.parentNode);return p.hasClass("zsafp-vitem-inp")?p[0]:o.hasClass("zsafp-vitem-inp")?o[0]:null}zssex.AutoFilterPopup=zk.$extends(zssex.CellPopup,{$init:function(p,o){this.$supers(zssex.AutoFilterPopup,"$init",arguments);this._pos={};this._field=o.field;this._rangeAddr=o.range;this._blank=o.blank;this._select=o.select;this._initItems(o.items,o.select,o.blank);this.setVisible(false);this._ccitems=o.ccitems;this._fcitems=o.fcitems;this._colorpat=o.colorpat;this._colorfg=o.colorfg;this._colorbg=o.colorbg;this._type=o.type;this._vitems=o.vitems;this._vitem=o.vitem;this._pitems=o.pitems;this._pitem=o.pitem;this._dynaf=o.dynaf;this._avgVal=o.avgVal;this._isAbove=o.isAbove;this._filterVal=o.filterVal;this._isTop=o.isTop;this._isPercent=o.isPercent;this._countVal=o.countVal;this._colName=o.colName},_initItems:function(p,o,t){var s=this._items=[{v:zssex.AutoFilterPopup.SELECT_ALL,s:o}],r=p.length;for(var q=0;q<r;q++){s.push(p[q])}if(t!=undefined){s.push({v:zssex.AutoFilterPopup.BLANK,s:t})}},unbind_:function(){delete this._pos;delete this._items;delete this._$is;this.listenSheetFocused_(false);var o=this.$n("inp");this.domUnlisten_(o,"onKeyDown",this._onFilterKeyDown);this.domUnlisten_(o,"onKeyUp",this._onFilterKeyUp);this.$supers(zssex.AutoFilterPopup,"unbind_",arguments)},open:function(q,t){if(this.isOpen()){this.close()}else{this.$supers(zssex.AutoFilterPopup,"open",arguments);var p=this.$n("inp"),o=this._select,s=jq(this._$items()[0]);p.focus();this.sheet.state=zss.SSheetCtrl.NOFOCUS;this.domListen_(p,"onKeyDown",this._onFilterKeyDown);this.domListen_(p,"onKeyUp",this._onFilterKeyUp);if("all"==o){s.addClass("zsafp-item-seld")}else{if("mix"==o){s.removeClass("zsafp-item-seld").addClass("zsafp-item-seld-mix")}}this.listenSheetFocused_(true)}},_$ccitems:function(){if(!this._$ccis){this._$ccis=jq(this.$n("ccitems")).children()}return this._$ccis},_$fcitems:function(){if(!this._$fcis){this._$fcis=jq(this.$n("fcitems")).children()}return this._$fcis},_$vitems:function(){if(!this._$vis){this._$vis=jq(this.$n("vitems")).children()}return this._$vis},_$pitems:function(){if(!this._$pis){this._$pis=jq(this.$n("pitems")).children()}return this._$pis},_$items:function(){if(!this._$is){this._$is=jq(this.$n("items")).children()}return this._$is},_onFilterKeyDown:function(o){this._prevFilterVal=o.domTarget.value},_onFilterKeyUp:function(w){var r=w.domTarget.value.toLowerCase(),u=this._prevFilterVal.length>r.length,p=this._$items(),t=true,s=false,q=this._items,v=this;v._filtered=r.length>0;p.each(function(x,z){var y=jq(z);if(x==0){if(v._filtered){y.addClass("zsafp-item-hide");q[0].h=true}else{y.removeClass("zsafp-item-hide");delete q[0].h}}else{if(u){if(y.hasClass("zsafp-item-hide")){if(y.text().toLowerCase().indexOf(r)>=0){y.removeClass("zsafp-item-hide");delete q[x].h}}if(!q[x].h){if(v._filtered||q[x].s){y.addClass("zsafp-item-seld");s=true}else{y.removeClass("zsafp-item-seld");t=false}}}else{if(y.text().toLowerCase().indexOf(r)<0){y.addClass("zsafp-item-hide");q[x].h=true;t=false}else{if(v._filtered||q[x].s){y.addClass("zsafp-item-seld");s=true}else{y.removeClass("zsafp-item-seld")}}}}});var o=jq(this.$n("okBtn"));if(t){q[0].s="all";o.removeClass("zsafp-btn-disd")}else{if(s){q[0].s="mix";o.removeClass("zsafp-btn-disd")}else{q[0].s="none";o.addClass("zsafp-btn-disd")}}f(this.$n("colordlg"));f(this.$n("valuedlg"));f(this.$n("perioddlg"))},close:function(){var o=this;setTimeout(function(){o.listenSheetFocused_(false);o.sheet.dp.gainFocus(false)});this.$supers(zssex.AutoFilterPopup,"close",arguments);this.detach();delete this._filtered},contentHTML_:function(){var u=this.uuid,A=this._items,z=A.length,I=this._colorpat,r=this._type,B=this._vitem,x='<div class="zsafp-popup-cave">';var t=(this._ccitems&&this._ccitems.length>1),p=(this._fcitems&&this._fcitems.length>1),s=t||p;var F=s||B||this._select!="all";x+='<div class="zsafp-itemsdlg">';x+='<div class="zsafp-clear '+(F?"":" zsafp-clear-disabled")+'"><div class="'+(F?"zsafp-clear-seld ":" ")+'zsafp-clear-icon"></div>Clear Filter From "'+this._colName+'"</div>';x+='<div class="zsafp-color '+(s?"":" zsafp-color-disabled")+'"><div class="'+(I?"zsafp-color-seld ":" ")+'zsafp-color-checkbox"></div>Filter by Color<div class="zsafp-color-more"></div></div>';x+='<div class="zsafp-value"><div class="'+(B?"zsafp-value-seld ":" ")+'zsafp-value-checkbox"></div>'+(r==1?"Date":r==2?"Number":"Text")+' Filters<div class="zsafp-value-more"></div></div>';x+='<div class="zsafp-search"><div class="zsafp-search-cnt"><input id="'+u+'-inp" class="zsafp-search-inp" type="text" autocomplete="off" tabindex="0"></input><div class="zsafp-search-icon"></div></div></div>';x+='<div id="'+u+'-items" class="zsafp-items">';for(var E=0;E<z;E++){var G=A[E];var y=!G.s||G.s=="none"?"":G.s=="mix"?" zsafp-item-seld-mix":" zsafp-item-seld";x+='<div class="zsafp-item'+y+'"><div class="zsafp-item-checkbox"></div>';if(zk.ie6_){x+='<div class="zsafp-item-text">'+G.v+"</div></div>"}else{x+=(G.v+"</div>")}}x+="</div>";x+='<div id="'+u+'-btns" class="zsafp-btns"><div id="'+u+'-okBtn" class="zsafp-btn zsafp-ok-btn"></div><div id="'+u+'-cancelBtn" class="zsafp-btn zsafp-cancel-btn"></div></div>';x+="</div>";if(s){x+='<div id="'+u+'-colordlg" class="zsafp-colordlg">';if(t){x+='<div class="zsafp-colordlg-title">Filter by Cell Color</div><div id="'+u+'-ccitems" class="zsafp-ccitems">';var D=this._ccitems?this._ccitems.length:0;for(var E=0;E<D;++E){var o=this._ccitems[E];x+='<div class="zsafp-ccitem'+(o.s?" zsafp-ccitem-seld":"")+'"><div class="zsafp-ccitem-checkbox"></div>';x+='<div class="zsafp-ccitem-fill"'+(o.bk?' style="'+o.bk+'">':">")+o.t+"</div></div>"}x+="</div>"}if(p){x+='<div class="zsafp-colordlg-title">Filter by Font Color</div><div id="'+u+'-fcitems" class="zsafp-fcitems">';var q=this._fcitems?this._fcitems.length:0;for(var E=0;E<q;++E){var w=this._fcitems[E];x+='<div class="zsafp-fcitem'+(w.s?" zsafp-fcitem-seld":"")+'"><div class="zsafp-fcitem-checkbox"></div>';x+='<div class="zsafp-fcitem-fill"'+(w.bk?' style="'+w.bk+'">':">")+w.t+"</div></div>"}x+="</div>"}x+="</div>"}x+='<div id="'+u+'-valuedlg" class="zsafp-valuedlg">';x+='<div id="'+u+'-vitems" class="zsafp-vitems">';var v=this._vitems?this._vitems.length:0;for(var E=0;E<v;++E){var B=this._vitems[E];if(B.op=="allDatesInPeriod"){x+='<div class="zsafp-vitem zsafp-vitem-inp'+(B.b?" zsafp-vitem-border":"")+(B.s?" zsafp-vitem-seld":"")+'"><div class="zsafp-vitem-checkbox"></div>'+(B.t+'<div class="zsafp-vitem-inp-more"></div></div>')}else{x+='<div class="zsafp-vitem'+(B.b?" zsafp-vitem-border":"")+(B.s?" zsafp-vitem-seld":"")+'"><div class="zsafp-vitem-checkbox"></div>'+(B.t+"</div>")}}x+="</div>";x+="</div>";x+='<div id="'+u+'-perioddlg" class="zsafp-perioddlg zsafp-vitem-inp">';x+='<div id="'+u+'-pitems" class="zsafp-vitems zsafp-vitem-inp">';var C=this._pitems?this._pitems.length:0;for(var E=0;E<C;++E){var H=this._pitems[E];x+='<div class="zsafp-vitem zsafp-vitem-inp'+(H.b?" zsafp-vitem-border":"")+(H.s?" zsafp-vitem-seld":"")+'"><div class="zsafp-vitem-checkbox"></div>'+(H.t+"</div>")}x+="</div>";x+="</div>";x+="</div>";return x},onSheetFocused:function(o){this.close()},relocate:function(u,o){var q=jq(this.$n());if((zk.ie6_||zk.ie7_)&&!q.width()){q.addClass("zsafp-popup")}var p=this.sheet,r=p.leftWidth,t=j(this.sheet,u,o),s=Math.max(r,t.right-zk.parseInt(q.width()));jq(this.$n()).css({left:jq.px(s),top:jq.px(t.bottom),border:"none","box-shadow":"none",background:"transparent",overflow:"visible"});return t},doMouseOver_:function(p){var s=m(p.domTarget);if(s!=null){i(s);f(this.$n("colordlg"));f(this.$n("valuedlg"));f(this.$n("perioddlg"));return}var q=g(p.domTarget);if(q!=null){f(this.$n("valuedlg"));f(this.$n("perioddlg"));c(this.$n("colordlg"))}var o=e(p.domTarget);if(o!=null){f(this.$n("colordlg"));c(this.$n("valuedlg"))}var r=d(p.domTarget);if(r!=null){c(this.$n("perioddlg"))}else{f(this.$n("perioddlg"))}},doMouseMove_:function(o){},_selectNone:function(){var q=this._items,p=this._$items(),r=q.length;while(r--){var u=q[r],t=u.s,s=jq(p[r]);if(r==0){u.s="none";var o=jq(this.$n("okBtn"));if("mix"==t){s.removeClass("zsafp-item-seld-mix");o.addClass("zsafp-btn-disd")}else{if("all"==t){s.removeClass("zsafp-item-seld");o.addClass("zsafp-btn-disd")}}}else{u.s=false;if(t){s.removeClass("zsafp-item-seld")}}}},_selectAll:function(){var p=this._items,o=this._$items(),q=p.length;while(q--){var t=p[q],s=t.s,r=jq(o[q]);if(q==0){t.s="all";if("mix"==s){r.removeClass("zsafp-item-seld-mix").addClass("zsafp-item-seld")}else{if("none"==s){r.addClass("zsafp-item-seld");jq(this.$n("okBtn")).removeClass("zsafp-btn-disd")}}}else{t.s=true;if(!s){r.addClass("zsafp-item-seld")}}}},_isSelectAll:function(){return"all"==this._items[0].s||this._clearFilter},_isSelectNone:function(){return"none"==this._items[0].s},_updateSelectAllItem:function(){var p=this._items,q=p.length,s=true,o=false,u=this._items[0].s;while(q--){var t=p[q];if(q==0){var r=jq(this._$items()[0]);if(s){r.addClass("zsafp-item-seld");t.s="all"}else{if(o){r.addClass("zsafp-item-seld-mix");t.s="mix"}else{t.s="none";jq(this.$n("okBtn")).addClass("zsafp-btn-disd")}}if(u!=t.s){if("all"==u){r.removeClass("zsafp-item-seld")}else{if("mix"==u){r.removeClass("zsafp-item-seld-mix")}else{jq(this.$n("okBtn")).removeClass("zsafp-btn-disd")}}}}else{if((this._filtered&&!t.h)||(!this._filtered&&t.s)){o=true}else{s=false}}}},_showTop10Filter:function(){this.sheet._wgt.fireSheetAction("top10Filter",{op:(this._vitem0==null?null:this._vitem0.op),field:this._field})},_showCustomFilters:function(){this.sheet._wgt.fireSheetAction("customFilters",{op:(this._vitem0==null?null:this._vitem0.op),field:this._field})},_clickVItem:function(o){this._clickVItem0(this._vitems,this._$vitems()[0],o);if(this._vitem0==null){this._clickVItem0(this._pitems,this._$pitems()[0],o)}},_clickVItem0:function(o,s,r){var q=o.length,p=0;this._vitem0=null;for(;s;s=s.nextSibling,p++){if(s==r){this._vitem0=o[p];break}}},_clickClear:function(){this._ccitem=null;this._fcitem=null;this._vitem0=null;this._clearFilter=true},_clickCCItem:function(s){var o=this._ccitems,q=o.length,p=0,r=this._$ccitems()[0];this._ccitem=null;for(;r;r=r.nextSibling,p++){if(r==s){this._ccitem=o[p];break}}},_clickFCItem:function(s){var o=this._fcitems,q=o.length,p=0,r=this._$fcitems()[0];this._fcitem=null;for(;r;r=r.nextSibling,p++){if(r==s){this._fcitem=o[p];break}}},_clickItem:function(v){var o=this._items,t=o.length,p=0,s=false,u=this._$items()[0];for(;u;u=u.nextSibling,p++){if(u==v){var r=o[p];if(p==0){var q=r.s;if("all"==q){this._selectNone()}else{if("mix"==q||"none"==q){this._selectAll()}}}else{s=true;jq(v)[r.s?"removeClass":"addClass"]("zsafp-item-seld");r.s=!r.s}break}}if(s){this._updateSelectAllItem()}},_isButton:function(q){var o=this.$n("okBtn"),p=this.$n("cancelBtn");if(zUtl.isAncestor(o,q)){return"ok"}else{if(zUtl.isAncestor(p,q)){return"cancel"}}},doMouseDown_:function(x){var s=x.domTarget,p=this._isButton(s);if(p){if("ok"==p){if(!this._isSelectNone()){this._applyFilter();this.close()}}else{if("cancel"==p){this.close()}}return}var t=k(s);if(t){this._clickClear();this._applyFilter();this.close();return}var u=n(s);if(u){this._clickCCItem(u);this._applyFilter();this.close();return}var v=a(s);if(v){this._clickFCItem(v);this._applyFilter();this.close();return}var q=b(s);if(q){this._clickVItem(q);var w=(this._vitem0.op=="aboveAverage"||this._vitem0.op=="belowAverage"||this._vitem0.op=="tomorrow"||this._vitem0.op=="today"||this._vitem0.op=="yesterday"||this._vitem0.op=="nextWeek"||this._vitem0.op=="thisWeek"||this._vitem0.op=="lastWeek"||this._vitem0.op=="nextMonth"||this._vitem0.op=="thisMonth"||this._vitem0.op=="lastMonth"||this._vitem0.op=="nextQuarter"||this._vitem0.op=="thisQuarter"||this._vitem0.op=="lastQuarter"||this._vitem0.op=="nextYear"||this._vitem0.op=="thisYear"||this._vitem0.op=="lastYear"||this._vitem0.op=="yearToDate"||this._vitem0.op=="Q1"||this._vitem0.op=="Q2"||this._vitem0.op=="Q3"||this._vitem0.op=="Q4"||this._vitem0.op=="M1"||this._vitem0.op=="M2"||this._vitem0.op=="M3"||this._vitem0.op=="M4"||this._vitem0.op=="M5"||this._vitem0.op=="M6"||this._vitem0.op=="M7"||this._vitem0.op=="M8"||this._vitem0.op=="M9"||this._vitem0.op=="M10"||this._vitem0.op=="M11"||this._vitem0.op=="M12");if(w){this._applyFilter()}else{if(this._vitem0.op=="top10"){this._showTop10Filter()}else{this._showCustomFilters()}}this.close();return}var o=m(s),r=this.$n("inp");if(o){this._clickItem(o)}setTimeout(function(){r.focus()},0)},doKeyPress_:function(o){},_getCriteria:function(){var p=[],o=this._items,r=o.length,t=r-1,u=this._blank;for(var q=1;q<r;q++){var s=o[q];if(q==t&&u!=undefined){if((this._filtered&&!s.h)||(!this._filtered&&s.s)){p.push("=")}}else{if((this._filtered&&!s.h)||(!this._filtered&&s.s)){p.push(s.v)}}}return p},_applyFilter:function(){var p={type:"apply",field:this._field,range:this._rangeAddr};if(this._ccitem){p.op="cellColor";p.all=false;var o=[];o.push(this._ccitem.pat);if(this._ccitem.pat=="SOLID"){o.push(this._ccitem.bg);o.push(this._ccitem.fg)}else{o.push(this._ccitem.fg);o.push(this._ccitem.bg)}p.criteria=o}else{if(this._fcitem){p.op="fontColor";p.all=false;var o=[];o.push(this._fcitem.pat);o.push(this._fcitem.fg);o.push(this._fcitem.bg);p.criteria=o}else{if(this._vitem0){p.op=this._vitem0.op;p.all=false}else{p.op="values";p.all=this._isSelectAll();if(!p.all){p.criteria=this._getCriteria()}}}}this.sheet._wgt.fire("onZSSFilter",p,{toServer:true})},_prevVisibleItem:function(p){for(var o=p.previousSibling;o;o=o.previousSibling){if(o&&o.className.indexOf("zsafp-item-hide")<0){return o}}},_nextVisibleItem:function(p){for(var o=p.nextSibling;o;o=o.nextSibling){if(o&&o.className.indexOf("zsafp-item-hide")<0){return o}}},_firstVisibleItem:function(){for(var o=this._$items()[0];o;o=o.nextSibling){if(o&&o.className.indexOf("zsafp-item-hide")<0){return o}}},doKeyDown_:function(p){var o=p.keyCode;switch(o){case 38:case 40:var q=this.$n("items"),r=jq(q).children(".zsafp-item-over")[0];if(r){var s=(o==38)?this._prevVisibleItem(r):this._nextVisibleItem(r);if(s){jq(s).addClass("zsafp-item-over");jq(r).removeClass("zsafp-item-over")}}else{jq(this._firstVisibleItem()).addClass("zsafp-item-over")}break;case 13:if(!this._isSelectNone()){this._applyFilter();this.close()}break;case 27:this.close()}}},{SELECT_ALL:"(Select All)",BLANK:"(Blanks)"})})();
zkreg('zssex.Popup');
(function(){zssex.Richtextbox=zk.$extends(zul.wgt.Div,{_content:"",_init:function(){this.editor=jq(this.$n()).cleditor({width:550,height:200,controls:"bold italic underline strikethrough subscript superscript font size color",fonts:"Arial, Arial Black, Comic Sans MS, Courier New, Georgia, Impact,Lucida Console, Lucida Sans Unicode, Palatino Linotype, Tahoma,Times New Roman, Trebuchet MS, Verdana, MS Sans Serif, MS Serif",sizes:"8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72",docType:"<!DOCTYPE html>",useCSS:false,bodyStyle:"margin:8px; font-size:11pt; font-family:Calibri; cursor:text"})[0];this._colorNode=$(".cleditorButton[title='Font Color']")[0];this._colorPopup=new zss.ColorPopup(this._colorNode);var b=this._colorPopup;b.adjustPosition_=function(){if(this._ref){zk(this.$n("pp")).position(this._ref,this._getPosition())}};this.parent.appendChild(this._colorPopup);if(b){b.listen({onChange:this.proxy(this.onChange)})}this.editor.wgt=this;var a=this.editor;jq(this.$n()).val(this._content);a.updateFrame();a.blurred(function(c){this.wgt.fire("onChange",{value:this.doc.body.innerHTML})});a.focus()},_deferInit:function(){if(this._initId){clearTimeout(this._initId);delete this._initId}var a=this;if(this.$n()){this._init()}else{this._initId=setTimeout(function(){a._deferInit()},50)}},adjustPosition_:function(){if(this._ref){zk(this.$n("pp")).position(this._ref,this._getPosition())}},setContent:function(a){if(this._content===a){return}this._content=a},openColorPopup:function(){var a=this._colorPopup;if(a){a.open(null,null,"after_start")}},bind_:function(){this.$supers(zul.wgt.Div,"bind_",arguments);var a=this;setTimeout(function(){a._init()},100)},unbind_:function(){if(this._colorPopup){this._colorPopup.unlisten({onChange:this.proxy(this.onChange)})}this.$supers(zul.wgt.Div,"unbind_",arguments)},onChange:function(a){var c=a.data.color,b=this.editor;if(b){b.execCommand("forecolor",c,false,this._colorNode);this.fire("onChange",{value:b.doc.body.innerHTML})}}})})();
zkreg('zssex.Richtextbox');
zk._m={};
zk._m['default']=function(a){a.push("<textarea",this.domAttrs_(),"></textarea>")};
;zkmld(zk._p.p.Richtextbox,zk._m);
(function(){var e={},b={},a={},d={},c={};zk.override(zss.Spreadsheet.prototype,e,{setTableFilters:function(g){var i=this.sheetCtrl;if(i){for(var h in g){var f=g[h];this._prepareAutoFilter(i,this._tableFilters?this._tableFilters[h]:null,f)}}this._tableFilters=g},_prepareAutoFilter:function(n,p,q){var g=p?p.range.top:-1,h=p?p.range.left:-1,i=p?p.range.right:-1;if(p){var r=g>=0?n.getRow(g,h):null;if(r){for(var l=0,m=r.length;l<m;++l){var o=r[l];if(o){o.cleanFilterBtns(h,i)}else{break}}}}if(q){var f=q.range.top,k=q.range.left,r=n.getRow(f,k);if(r){for(var l=0,m=r.length;l<m;++l){var o=r[l];if(o){o.prepareFilterBtns_(q)}else{break}}}}},setATableFilter:function(f){var h=jq.evalJSON(f);var j=this.sheetCtrl;if(j){for(var i in h){var g=h[i];this._prepareAutoFilter(j,this._tableFilters?this._tableFilters[i]:null,g);if(g){this._tableFilters[i]=g}else{delete this._tableFilters[i]}}}},setAutoFilter:function(f){var g=this.sheetCtrl;if(g){this._prepareAutoFilter(g,this._autoFilter,f)}this._autoFilter=f},getAutoFilter:function(){return this._autoFilter},getTableFilters:function(){return this._tableFilters},setAutoFilterPopup:function(f){var g=this.sheetCtrl;if(g){g.openAutoFilterPopup_(f)}},setDataValidations:function(l){var i=this.sheetCtrl;if(i){this._clearDataValidations();var k=l?{}:null;var f=(l?l.length:0);for(var g=0;g<f;++g){var h=l[g];this._setDataValidation(h,h.id);k[h.id]=h}this._dataValidations=k;this._dvs=l;var n=i.dp,m=i.getLastFocus();if(n&&m){n.showValidateBtn_(m.row,m.column)}}},_setDataValidation:function(f,g){if(f.showPrompt){this.sheetCtrl.addValidationPromptPopup_(g,f.promptTitle,f.promptText)}var p=f.lists,l=(p?p.length:0);for(var h=0;h<l;++h){var o=p[h],i=o?o.rangeList:null,n=(i?i.length:0);for(var k=0;k<n;++k){var m=i[k];this._setValidateBtns(g,h,m)}if(o.validationList){this.sheetCtrl.addValidatePopup_(g,h,o.validationList)}}},_setValidateBtns:function(g,i,n){var k=n.left,f=n.right,u=n.top,s=n.bottom,p=this.sheetCtrl;for(var w=u;w<=s;++w){var v=p.getRow(w,h);if(v){for(var m=0,o=v.length;m<o;++m){var q=v[m];if(q){for(var h=k;h<=f;++h){q.prepareDataValidation_(g,i,h)}}else{break}}}}},getDataValidations:function(){return this._dvs},_clearDataValidations:function(){var f=this.sheetCtrl,g=this._dataValidations;if(f&&g){for(var h in g){this._clearDataValidation(g[h],h)}this._dataValidations=null;this._dvs=null}},_clearDataValidation:function(f,g){if(f.showPrompt){this.sheetCtrl.clearValidationPromptPopup_(g)}var p=f.lists,l=(p?p.length:0);for(var h=0;h<l;++h){var o=p[h],i=o?o.rangeList:null,n=(i?i.length:0);for(var k=0;k<n;++k){var m=i[k];this._clearValidateBtns(m)}if(o.validationList){this.sheetCtrl.clearValidatePopup_(g,h)}}},_clearValidateBtns:function(k){var h=k.left,f=k.right,q=k.top,p=k.bottom,n=this.sheetCtrl;for(var s=q;s<=p;++s){var u=n.getRow(s,g);if(u){for(var i=0,m=u.length;i<m;++i){var o=u[i];if(o){for(var g=h;g<=f;++g){o.cleanvbtns(g)}}else{break}}}}}});zk.override(zss.DataPanel.prototype,c,{moveFocus:function(k,g,f,h,j,i){c.moveFocus.apply(this,arguments);this.showValidateBtn_(k,g)},_gainFocus:function(f,h,g){c._gainFocus.apply(this,arguments);var i=this.sheet.getLastFocus();if(i){this.showValidateBtn_(i.row,i.column)}},showValidateBtn_:function(o,h){var m=this.sheet;m.cleanValidateBtns_();var p=m.getRow(o,h);if(p){for(var k=0,l=p.length;k<l;++k){var n=p[k];if(n){var f=n.getDataValidation_(h);if(f){if(f.showButton){var i=n.showValidateBtn_(h);if(i){m.addValidateBtn_(i)}}var g=m.getValidationPromptPopup_(f.id);if(g){g.open(o,h)}}}}}}});zk.override(zss.Row.prototype,b,{$init:function(f,i,h,g){b.$init.apply(this,arguments);this.btns={};this.vbtns={}},_prepareValidateBtns:function(){var v=this.sheet._wgt._dataValidations;if(v){for(var g in v){var h=v[g];if(h){var x=h.lists,q=(x?x.length:0);for(var m=0;m<q;++m){var u=x[m],o=u?u.rangeList:null,j=(o?o.length:0);for(var p=0;p<j;++p){var s=o[p],z=this.r,y=s.top,w=s.bottom,n=s.left,f=s.right;if(z>=y&&z<=w){for(var k=n;k<=f;k++){this.prepareDataValidation_(g,m,k)}}}}}}}},_prepareAllFilterBtns:function(){var g=this.sheet._wgt._autoFilter;this._prepareAutoFilterBtns(g);var f=this.sheet._wgt._tableFilters;for(var h in f){this._prepareAutoFilterBtns(f[h])}},_prepareAutoFilterBtns:function(f){if(f){var g=f.range.top;if(g==this.r){this.prepareFilterBtns_(f)}}},bind_:function(){b.bind_.apply(this,arguments);this._prepareValidateBtns();this._prepareAllFilterBtns()},unbind_:function(){b.unbind_.apply(this,arguments);this.cleanbtns();this.cleanvbtns()},cleanbtns:function(){if(this.btns){for(var g in this.btns){var f=this.btns[g];if(!f){break}f.cleanup()}this.btns={}}},cleanFilterBtns:function(i,h){if(this.btns){for(var j=i;j<=h;++j){var g="c"+j,f=this.btns[g];if(!f){continue}f.cleanup();delete this.btns[g]}}},cleanvbtns:function(f){if(this.vbtns){if(f){delete this.vbtns["c"+f]}else{this.vbtns={}}}},getBtnAt:function(f){return this.btns["c"+f]},prepareFilterBtns_:function(x){var l=this.r,r=this.$n();if(!x){return}this.cleanFilterBtns(x.range.left,x.range.right);var m=x.range,g=m.left,B=m.right,w=x.filterColumns,u=this.cells.length;if(u<=0){return}var t=this.cells[0].c,h=this.cells[u-1].c,j=Math.max(g,t),z=Math.min(B,h),y=0,v=w&&w.length>0?w[y]:null,o=null,C=null,A=null,i=null,n=null,p=true,f=null,s=null;for(var k=j;k<=z;++k){if(v&&v.col==k){f=v.field;var q=(g+f-1)==k;o=q?v.filter:s?s.filter:null;C=q?v.colorpat:s?s.colorpat:null;A=q?v.f1:s?s.f1:null;i=q?v.dynaf:s?s.dynaf:null;n=q?(v.filterVal!=undefined):s?(s.filterVal!=undefined):null;p=v.on;if(p){s=null}else{if(!s){s=v}}if(++y<w.length){v=w[y]}}else{p=true;if(s){f=s.field;o=s.filter;C=s.colorpat;A=s.f1;i=s.dynaf;n=s.filterVal!=undefined;s=null}else{o=null;C=null;A=null;i=null;n=null;f=k-g+1}}if(p){this.btns["c"+k]=new zssex.Btn(this.sheet,l,k,r,(o&&o.length>0)||C||A||i||n?"zsfilter":"zsdropdown",f,"af",t)}}},prepareDataValidation_:function(g,i,f){var h={};this.vbtns["c"+f]=h;h.dvj=g;h.listj=i},getDataValidation_:function(f){var g=this.vbtns["c"+f];if(g==null){return null}var h=this.sheet._wgt._dataValidations;if(h){return h[g.dvj]}},showValidateBtn_:function(f){var g=this.vbtns["c"+f];if(g==null){return null}var h=this.cells[0].c;return new zssex.Btn(this.sheet,this.r,f,this.$n(),"zsdropdown",g,"dv",h)}});zk.override(zss.CellBlockCtrl.prototype,a,{getBtn:function(j,h){var g=this.getFilterByRowCol(j,h),f=g?g.range:null,i=f?this.rows[j-this.range.top]:null;return i?i.getBtnAt(h):null},getFilterByRowCol:function(k,h){var g=this.sheet._wgt._autoFilter;if(this._isValidFilter(g,k,h)){return g}var f=this.sheet._wgt._tableFilters;for(var i in f){var j=f[i];if(this._isValidFilter(j,k,h)){return j}}return null},_isValidFilter:function(h,i,g){if(!h){return null}var f=h.range;if(i!=f.top||g<f.left||g>f.right){return null}return h}});zk.override(zss.SSheetCtrl.prototype,d,{_doBtndown:function(v,i,h,o){var j=this;if(j.state==zss.SSheetCtrl.NOFOCUS){j.dp.gainFocus();return}var p=j._wgt,n=(h)?h:v.domTarget,t,u=my=0,s=shy=0,m,k,l=zkS._getMouseData(v,this.comp),A="";if((t=zkS.parentByZSType(n,"SBtn",0))!=null){var w=t,B=zk(j.comp).revisedOffset(),z=zk(w).revisedOffset();u=v.pageX;my=v.pageY;s=Math.round(u-B[0]);shy=Math.round(my-B[1]);var q=u-z[0],r=zss.SSheetCtrl._calCellPos(j,u,my,false,i=="dv");m=r[0];k=r[1];A="c_"+m+"_"+k;if("dv"==i){k-=1;var g=j.getCell(m,k);if(g){if(g.merl&&g.merl<k){k=g.merl}if(g.mert&&g.mert<m){m=g.mert}}var y=o.field,f=this.getValidatePopup_(y.dvj,y.listj);if(f){f.open(m,k)}}p.fireCellEvt(i,s,shy,l[2],m,k,u,my,o.field)}},_syncAutoFilterBtns:function(g,i,f){if(g){if(i<0){i=g.range.top}if(i!=g.range.top){return}if(f<0){f=g.range.left}var h=g.range.right;for(var j=f;j<=h;++j){btn=this.getBtn(i,j);if(btn){btn.relocate(i,j)}}}},_syncAllFilterBtns:function(k,h){var g=this._wgt._autoFilter;this._syncAutoFilterBtns(g,k,h);var f=this._wgt._tableFilters;for(var i in f){var j=f[i];this._syncAutoFilterBtns(j,k,h)}},getBtn:function(j,g){var i=this.frozenRow,f=this.frozenCol,h=null;if(j<=i&&g<=f){h=this.cp.block.getBtn(j,g)}else{if(j<=i){h=this.tp.block.getBtn(j,g)}else{if(g<=f){h=this.lp.block.getBtn(j,g)}else{h=this.activeBlock.getBtn(j,g)}}}return h},_setRowHeight:function(k,f,j,g,i,h){d._setRowHeight.apply(this,arguments);this._syncAllFilterBtns(k,-1)},_setColumnWidth:function(g,i,k,f,j,h){d._setColumnWidth.apply(this,arguments);this._syncAllFilterBtns(-1,g)},addValidateBtn_:function(f){if(!this._vbtns){this._vbtns=[]}if(f){this._vbtns.push(f)}},cleanValidateBtns_:function(){if(this._vbtns){for(var h=0,f=this._vbtns.length;h<f;++h){var g=this._vbtns[h];g.cleanup()}this._vbtns=[]}},_index:function(f,g){return f+"_"+g},getValidatePopup_:function(f,g){if(!this._vpops){return null}return this._vpops[this._index(f,g)]},addValidatePopup_:function(g,i,h){if(!this._vpops){this._vpops={}}if(h){var f=new zssex.ValidationPopup(this);this.appendChild(f,true);f.setValidationList(h);this._vpops[this._index(g,i)]=f}},clearValidatePopup_:function(h,i){if(!this._vpops){return}var g=this._index(h,i);var f=this._vpops[g];if(f){this.removeChild(f)}delete this._vpops[g]},getValidationPromptPopup_:function(f){if(!this._vppops){return null}return this._vppops[f]},addValidationPromptPopup_:function(g,i,h){if(!this._vppops){this._vppops={}}if(i||h){var f=new zssex.ValidationPromptPopup(this,i,h);this.appendChild(f,true);this._vppops[g]=f}},clearValidationPromptPopup_:function(g){if(!this._vppops){return}var f=this._vppops[g];if(f){this.removeChild(f)}delete this._vppops[g]},openAutoFilterPopup_:function(f){var h=this._autoFilterPopup;if(h){h.detach()}var g=this._autoFilterPopup=new zssex.AutoFilterPopup(this,f);this.appendChild(g,true);g.open(f.row,f.col)}})})();
(function(){var d=0;var g=1;var c=2;var f=3;var a=4;var b=5;var e={};zk.override(zss.Cell.prototype,e,{_processOverflow:function(){var l=this.rotate==90||this.rotate==-90;if(l){return}var h=this.c;var j=this.rborder;var r=jq(this.$n());var t=this.$n("cave");var q=jq(t);var v=this.getTextNode();var p=jq(v);if(zk.ie6_||zk.ie7_){q.css("width","")}else{p.css("width","")}var n=this.sheet;var m=n.custColWidth;var i=m.getSize(h);var o=(this._txtwd==undefined||this._txtwd<0);var s=o?v.scrollWidth:this._txtwd;var k=n.cellPad;if(o){this._txtwd=s;n._sendOnTextWidth(this.r,h,s)}if(s<=m.getSize(this.c)-k){r.removeClass("zscell-overflow");r.removeClass("zscell-overflow-b");return}var u=this.nextSibling;while(u&&u.cellType===f&&i<s){i+=m.getSize(u.c);u=u.nextSibling}i-=k;r.removeClass(j?"zscell-overflow":"zscell-overflow-b").addClass(j?"zscell-overflow-b":"zscell-overflow");if(zk.ie6_||zk.ie7_){q.css("width",jq.px0(i))}else{p.css("width",jq.px0(i))}}})})();
(function(){var a={};zk.override(zss.Cell.prototype,a,{_colWidth:function(){var g=this.sheet,f=g.custColWidth,d=g.cellPad,b=0,h=this.merid?this.merl:this.c,e=this.merid?this.merr:h;for(var c=h;c<=e;++c){b+=f.getSize(c)}return b-2*d},_textWidth:function(){if(!this._txtwd){var b=this.getTextNode(),d=jq(b),c=jq("<span>"+d.html()+"</span>");c.css("font-size",d.css("font-size")).css("font-family",d.css("font-family")).hide();c.prependTo("body");this._txtwd=c.width();c.remove()}return this._txtwd},_processRotate:function(){var c=this.rotate;if(c!=90&&c!=-90){return}var p=this.$n("cave"),m=jq(p),o=this.$n("real"),q=this.getTextNode(),j="1.6em",l=this.fontSize,n,k,b,e;var i,g;if(zk.ie){n=Math.round(l*4/3);k=Math.round(l*2/3);b=Math.round(l*4*0.8/3);e=Math.round(l*4*1.6/3);if(zk.ie<10&&(c==-90||c==90)){i=this._textWidth();g=this._colWidth();if(i>g){o.style.width=""+i+"px"}}}m.css("text-align","");if(c==-90){var d="";switch(this.valign){case"t":if(zk.ie){if(zk.ie<10){i=i||this._textWidth();g=g||this._colWidth();var h=i<g?Math.floor(g/2)-k:Math.floor(i/2)-k;d="rotate(90deg) translate("+h+"px"}else{var h=-n;d="rotate(90deg) translate("+h+"px"}}else{d="rotate(90deg) translate(-1em"}break;case"c":i=i||this._textWidth();if(zk.ie){if(zk.ie<10){g=g||this._colWidth();var h=i<g?Math.floor((g-i)/2):0;d="rotate(90deg) translate("+h+"px"}else{var h=Math.floor(i/2)+k;d="rotate(90deg) translate(-"+h+"px"}}else{d="rotate(90deg) translate(calc(-"+Math.floor(i/2)+"px - 0.5em)"}break;case"b":i=i||this._textWidth();if(zk.ie&&zk.ie<10){g=g||this._colWidth();var h=i<g?k+Math.floor(g/2)-i:k-Math.floor(i/2);d="rotate(90deg) translate("+h+"px"}else{d="rotate(90deg) translate(-"+i+"px"}break}switch(this.halign){case"l":if(zk.ie&&zk.ie<10){i=i||this._textWidth();g=g||this._colWidth();var f=(i<g?Math.floor(g/2):Math.floor(i/2))-k;d+=","+f+"px)"}else{d+=",0px)"}break;case"c":g=g||this._colWidth();if(zk.ie){if(zk.ie<10){i=i||this._textWidth();var f=i<g?0:Math.floor((i-g)/2);d+=","+f+"px)"}else{var f=b-Math.floor(g/2);d+=","+f+"px)"}}else{d+=",calc("+j+" / 2 - "+Math.floor(g/2)+"px))"}break;case"r":g=g||this._colWidth();if(zk.ie){if(zk.ie<10){i=i||this._textWidth();var f=(i<g?-Math.floor(g/2):Math.floor(i/2)-g)+b;d+=","+f+"px)"}else{var f=e-g;d+=","+f+"px)"}}else{d+=",calc("+j+" - "+g+"px))"}break}o.style["transform-origin"]="left bottom 0";o.style[zk.ie&&zk.ie<10?"-ms-transform":"transform"]=d}else{if(c==90){var d="";switch(this.valign){case"b":if(zk.ie){if(zk.ie<10){i=i||this._textWidth();g=g||this._colWidth();var h=i<g?Math.floor(g/2)-k:Math.floor(i/2)-k;d="rotate(-90deg) translate("+h+"px"}else{var h=-n;d="rotate(-90deg) translate("+h+"px"}}else{d="rotate(-90deg) translate(-1em"}break;case"c":i=i||this._textWidth();if(zk.ie){if(zk.ie<10){g=g||this._colWidth();var h=i<g?Math.floor((g-i)/2):0;d="rotate(-90deg) translate("+h+"px"}else{var h=-Math.floor(i/2)-k;d="rotate(-90deg) translate("+h+"px"}}else{d="rotate(-90deg) translate(calc(-"+Math.floor(i/2)+"px - 0.5em)"}break;case"t":i=i||this._textWidth();if(zk.ie&&zk.ie<10){g=g||this._colWidth();var h=i<g?k+Math.floor(g/2)-i:k-Math.floor(i/2);d="rotate(-90deg) translate("+h+"px"}else{d="rotate(-90deg) translate(-"+i+"px"}break}switch(this.halign){case"l":if(zk.ie&&zk.ie<10){i=i||this._textWidth();g=g||this._colWidth();var f=(i<g?-Math.floor(g/2):-Math.floor(i/2))+k;d+=","+f+"px)"}else{d+=",0px)"}break;case"c":g=g||this._colWidth();if(zk.ie){if(zk.ie<10){i=i||this._textWidth();var f=i<g?0:-Math.floor((i-g)/2);d+=","+f+"px)"}else{var f=Math.floor(g/2)-b;d+=","+f+"px)"}}else{d+=",calc("+Math.floor(g/2)+"px - "+j+" / 2))"}break;case"r":g=g||this._colWidth();if(zk.ie){if(zk.ie<10){i=i||this._textWidth();var f=(i<g?Math.floor(g/2):g-Math.floor(i/2))-b;d+=","+f+"px)"}else{var f=g-e;d+=","+f+"px)"}}else{d+=",calc("+g+"px - "+j+"))"}break}o.style["transform-origin"]="left top 0";o.style[zk.ie&&zk.ie<10?"-ms-transform":"transform"]=d}}}})})();
(function(){var b={},a={},c={};zk.override(zss.Cell.prototype,b,{_getTextHeight0:function(){var e=jq(this.$n()),f=this.rotate,g=this.getTextNode();if(g){if(!g.textContent||g.textContent.trim().length==0){return 0}}var h=jq(g.cloneNode(true)).css({position:"absolute",left:"-10000px",top:"-10000px",height:"","max-height":"999999px",width:g.offsetWidth}).appendTo(this.cave),d=(f==90||f==-90)?this._textWidth():h.height();if(zk.ie&&zk.ie<10&&d>=10000){d-=10000}h.remove();return d},_saveNoneDefaultHeightCell:function(){var d=this.sheet.custRowHeight,e=this.r;if(!d.isDefaultSize(e)&&!d.isCustomSize(e)){this.parent.addAutoHeightCell(this)}}});zk.override(zss.Row.prototype,a,{$init:function(d){a.$init.apply(this,arguments);this.autoHeightCells=[]},updateRowAutoHeight:function(){if(this.sheet.custRowHeight.isCustomSize(this.r)){return}var f=this.sheet.custRowHeight.getDefaultSize(),e=this.autoHeightCells;if(e.length>0){var d=this._largestAutoHeight||-1;if(d==-1){var h=e.length;while(h--){if(e[h]){f=Math.max(f,e[h].getTextHeight())}}this._largestAutoHeight=f}else{f=Math.max(f,d)}}if(jq(this.$n()).height()==f){return}var g=false;this.sheet._setRowHeight(this.r,f,true,false,false,this.zsh,g)},updateAutoHeightDirty:function(d,f){var e=this._largestAutoHeight||this.sheet.custRowHeight.getDefaultSize();if(f>e){this._largestAutoHeight=f}else{if(d==e){this._largestAutoHeight=-1}}},processCellAutoHeight:function(d){if(!this.sheet.custRowHeight.isCustomSize(this.r)){this.addAutoHeightCell(d);this.sheet.triggerAutoHeight(this.r)}},addAutoHeightCell:function(d){var e=this.autoHeightCells;if(!e.$contains(d)){e.push(d)}},removeAutoHeightCell:function(d){var e=this.autoHeightCells;if(e.$contains(d)){e.$remove(d)}}});zk.override(zss.SSheetCtrl.prototype,c,{fireProcessAutoHeight_:function(){if(this._wgt.isSheetCSSReady()){var d=this._autoHeightRange,g=this.activeBlock,f=g.range;if(d!=undefined){var m=this.custRowHeight,j=Math.max(d.tRow,f.top),e=Math.min(d.bRow,f.bottom);for(var h=j;h<=e;h++){if(!m.isHidden.apply(m,[h])){var l=g.getRow(h);l.updateRowAutoHeight.apply(l)}}delete this._autoHeightRange}}else{var k=this;setTimeout(function(){k.fireProcessAutoHeight_()},25)}},triggerAutoHeight:function(e){var d=this._autoHeightRange=this._autoHeightRange||{};typeof d.tRow=="undefined"?d.tRow=e:d.tRow=Math.min(d.tRow,e);typeof d.bRow=="undefined"?d.bRow=e:d.bRow=Math.max(d.bRow,e)},})})();
(function(){var c={},a={},b={};zk.override(zss.SSheetCtrl.prototype,c,{doMouseOver_:function(i){c.doMouseOver_.apply(this,arguments);var e=i.target,k=jq(i.domTarget);if(k.hasClass("zsselecti")||k.hasClass("zshighlight")||k.hasClass("zshighlighti")){var h=i.pageX,f=i.pageY,j=zss.SSheetCtrl._calCellPos(this,h,f,false),l=j[0],d=j[1],g=this.getCell(l,d);if(g!=null&&g.merr){g=this.getCell(g.mert,g.merl)}if(g){this._showCellComment(g)}}},doCellMouseOver:function(d){if(c.doCellMouseOver){c.doCellMouseOver.apply(this,arguments)}var e=d.target;if(e.widgetName==="Cell"){this._showCellComment(e)}},_showCellComment:function(f){if(this._hoverCell!==f){var e=this.commentWindow,d=this.getStyleMenupopup();this._hovercell=f;if(!(d&&d.isOpen())&&f.comment){jq(e.$n("cave")).html(f.comment.t);e.open(f,null,"end_before",{dodgeRef:true})}else{if(e.isOpen()){e.close()}}}},bind_:function(f,e,d){c.bind_.apply(this,arguments);this.appendChild(this.commentWindow=new zul.wgt.Popup({sclass:"zscellcomment-popup"}))},unbind_:function(){this.commentWindow=null;c.unbind_.apply(this,arguments)}});zk.override(zss.Cell.prototype,a,{doMouseOver_:function(d){this.sheet.doCellMouseOver(d);a.doMouseOver_.apply(this,arguments)},update_:function(){a.update_.apply(this,arguments);var e=this.r,g=this.c,f=this.src.getRow(e).getCell(g),d=f.comment;if(d!=this.comment){this.comment=d;jq(this.$n("comment"))[d?"removeClass":"addClass"]("zscellcomment-hidden")}},getCommentHtml:function(d){return'<div id="'+this.uuid+'-comment" class="zscellcomment '+(d?"":"zscellcomment-hidden")+'"></div>'}});zk.override(zss.Row.prototype,b,{doMouseOver_:function(f){var g=this.sheet,k=f.pageX,i=f.pageY,e=zss.SSheetCtrl._calCellPos(g,k,i),j=e[0],h=e[1],d=g.getCell(j,h);if(d!=null&&d.merr){d=g.getCell(d.mert,d.merl)}if(d){this.sheet._showCellComment(d)}b.doMouseOver_.apply(this,arguments)},})})();

}finally{zk.setLoaded(zk._p.n);}});zk.setLoaded('zssex',1);