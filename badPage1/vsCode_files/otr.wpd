zk.load('zul.mesh,zul.menu,zul.sel,zul.grid,zul.inp,zul.db,zul.wgt,zkmax.inp',function(){if(zk._p=zkpi('otr'))try{
otr.AdvGrid=zk.$extends(zul.grid.Grid,{$init:function(){this.$supers("$init",arguments)}});
zkreg('otr.AdvGrid');
zk._m={};
zk._m['default']=function(h){var b=this.uuid,e=this.getZclass(),k=this.getInnerWidth(),l=k=="100%"?' width="100%"':"",c=k!="100%"?"width:"+k:"",a=this.inPagingMold(),d;h.push("<div",this.domAttrs_(),">");if(a&&this.paging){d=this.getPagingPosition();if(d=="top"||d=="both"){h.push('<div id="',b,'-pgit" class="',e,'-pgi-t">');this.paging.redraw(h);h.push("</div>")}}if(this.columns){h.push('<div id="',b,'-head" class="',e,'-header">',"<table",l,zUtl.cellps0,' style="table-layout:fixed;',c,'">');this.domFaker_(h,"-hdfaker",e);for(var m=this.heads,g=0,i=m.length;g<i;){m[g++].redraw(h)}h.push('</table></div><div class="',e,'-header-bg"></div>')}if(this.foot){h.push('<div id="',b,'-foot" class="',e,'-footer">',"<table",l,zUtl.cellps0,' style="table-layout:fixed;',c,'">');if(this.columns){this.domFaker_(h,"-ftfaker",e)}this.foot.redraw(h);h.push("</table></div>")}h.push('<div id="',b,'-body" class="',e,'-body"');var f=this.getHeight();if(f){h.push(' style="height:',f,'"')}h.push("><table",l,zUtl.cellps0,' style="table-layout:fixed;',c,'"');h.push(">");if(this.columns){this.domFaker_(h,"-bdfaker",e)}if(this.rows){if(this.domPad_&&!this.inPagingMold()){this.domPad_(h,"-tpad")}this.rows.redraw(h);if(this.domPad_&&!this.inPagingMold()){this.domPad_(h,"-bpad")}}this.redrawEmpty_(h);h.push("</table></div>");if(this.frozen){h.push('<div id="',b,'-frozen" class="',e,'-frozen">');this.frozen.redraw(h);h.push("</div>")}if(d=="bottom"||d=="both"){h.push('<div id="',b,'-pgib" class="',e,'-pgi-b">');this.paging.redraw(h);h.push("</div>")}h.push("</div>")};
;zkmld(zk._p.p.AdvGrid,zk._m);
(function(){function a(e,d){return zAu.processing()||e._shallIgnore(d)}function c(d){switch(d.data.keyCode){case 33:case 34:case 38:case 40:case 37:case 39:case 32:case 36:case 35:d.stop();return false}return true}function b(e){if(e.desktop&&e._headercm&&e._multiple){var f=zk.Widget.$(e._headercm).getZclass()+"-checked",d=jq(e._headercm);d[e._isAllSelected()?"addClass":"removeClass"](f)}}otr.ListboxFakePaging=zk.$extends(zul.sel.Listbox,{checkedAllGlobal:false,focusListenerPresent:false,setCheckmarkValue:function(d){if(this._headercm&&this._multiple&&this.listhead){this.checkedAllGlobal=d;this._updHeaderCM()}},setFocusListener:function(d){this.focusListenerPresent=d},_updHeaderCM:function(){var d;if(this._headercm&&this._multiple&&(d=this.listhead)&&(d=d.firstChild)){d._checked=this.checkedAllGlobal}if(this._headercm&&this._multiple){var f=this,e;this._nUpdHeaderCM=(e=this._nUpdHeaderCM)>0?e+1:1;setTimeout(function(){b(f)},100)}},_afterCalcSize:function(){this.$supers("_afterCalcSize");if(zk.chrome){var e=this.head?this.head.$n("hdfaker-bar"):null;if(e){var d=this.$n("headtbl");d.style.width=jq.px(zk.parseInt(d.style.width)+zk.parseInt(e.style.width))}}},_isAllSelected:function(){return this.checkedAllGlobal},_doKeyDown:function(q){if(a(this,q)){return true}var t=this._focusItem||this.getSelectedItem(),k=q.data,f=k.shiftKey,e=(k.ctrlKey||k.metaKey);if(f&&!this._multiple){f=false}var o=false,h,s;if(zk.webkit&&typeof k.keyCode=="string"){k.keyCode=zk.parseInt(k.keyCode)}switch(k.keyCode){case 33:case 34:var g=this.paging||this._paginal;if(t&&g){var l=this.getActivePage()+(k.keyCode==33?-1:1);if(l>-1&&l<this.getPageCount()){this.fire("onAcrossPage",{page:l,offset:this.indexOfItem(t),shift:!f||!this._multiple?0:k.keyCode==33?this.getPageSize():-this.getPageSize()})}return}h=this._visibleRows();if(h==0){h=this.getPageSize()||20}if(k.keyCode==33){h=-h}break;case 38:case 40:h=k.keyCode==40?1:-1;break;case 32:if(t){if(this._multiple){this._toggleSelect(t,!t.isSelected(),q)}else{this._select(t,q)}}break;case 36:case 35:h=k.keyCode==35?1:-1;o=true;break;case 37:if(t){this._doLeft(t)}break;case 39:if(t){this._doRight(t)}break}if(h>0||(h<0&&t)){if(t&&f&&!t.isDisabled()){this._toggleSelect(t,true,q)}var j=t?t.$n():null;for(;;){if(!j){var p=this.getBodyWidgetIterator().next();if(p){j=p.$n()}else{return}}else{if(h>0){j=j.nextSibling;if(j&&j.previousSibling&&j.previousSibling.childNodes){j.previousSibling.childNodes.forEach(function(r){r.classList.remove("z-listitem-focus")})}}else{j=j.previousSibling;if(j&&j.nextSibling&&j.nextSibling.childNodes){j.nextSibling.childNodes.forEach(function(r){r.classList.remove("z-listitem-focus")})}}if(j){j.childNodes.forEach(function(r){r.classList.add("z-listitem-focus")})}}if(!j){if(o){break}var m=this.paging||this._paginal,i;if(m){i=m.getActivePage();if(h>0?(i+1<m.getPageCount()):i>0){this.fire("onAcrossPage",{page:i+(h>0?1:0),offset:h>0?0:-1,shift:!this._multiple||!f?0:h>0?-1:1})}}break}var d=zk.Widget.$(j);if(d.$instanceof(zul.sel.Treerow)){d=d.parent}if(!d.isDisabled()){if(f){this._toggleSelect(d,true,q)}if(zk(j).isVisible()){if(!f){s=d}if(!o){if(h>0){--h}else{++h}if(h==0){break}}}}}}if(s){if(e||k.keyCode==38||k.keyCode==40){this._focus(s)}else{this._select(s,q)}this._syncFocus(s);var n=this._scrollbar;if(n){n.scrollToElement(s.$n())}else{zk(s.$n()).scrollIntoView(this.ebody)}}if(this.focusListenerPresent&&(k.keyCode==38||k.keyCode==40)){zAu.send(new zk.Event(this,"onUser",{command:"focusItem",index:this._focusItem?this._focusItem._index:null}))}return c(q)},fireOnSelect:function(e,m){var f=m.domTarget.classList.contains("z-listheader-checkable");if(!f){f=m.domTarget.parentNode.classList.contains("z-listheader-checkable")}if(f){return}var h=[];for(var i=this.getSelectedItems(),g=i.length;g--;){if(i[g].isSelected()){h.push(i[g])}}var l,d=true;if(m){l=m.data;if(this._multiple){d=l.ctrlKey||l.metaKey||l.shiftKey||this._checkmark||m.keyCode==38||m.keyCode==40}}var k=getClickOnCheckmark(m);this.fire("onSelect",zk.copy({items:h,reference:e,clearFirst:!d,selectAll:f,clickOnCheckmark:k},l))},syncSize:function(){if(this.desktop){this.clearCachedSize_();this._calcMinWds();this._fixHeaders();this.onSize()}},replaceWidget:function(d){this.$supers("replaceWidget",arguments);d.checkedAllGlobal=this.checkedAllGlobal},onSize:function(){this.$supers("onSize",arguments);if(this._rows){this._calcHgh()}}})})();function getClickOnCheckmark(i){var c;var e;var d;var g=$(jq(".doc-dialog-content"));if(!g||!g[0]){var f=$(jq(".z-listitem-checkable"));if(!f||!f[0]){return false}d=$(f[0])}else{var a=$(jq(".doc-dialog-content")[0]).find(".z-listitem-checkable");if(!a||!a[0]){return false}d=$(a[0])}c=d.width()+2;e=d.offset().left;var h=i.pageX;var b=h-e;return !(b<0||b>c)}var _Cwgt2={};zk.override(zul.sel.Listitem.prototype,_Cwgt2,{_setSelectedDirectly:function(a){var b=this.$n();if(b){jq(b)[a?"addClass":"removeClass"](this.$s("selected"))}this._selected=a}});
zkreg('otr.ListboxFakePaging');
otr.MaskInput=zk.$extends(zul.inp.Textbox,{_mask:"",_rawval:"",$define:{mask:function(a){if(this.desktop){var c=this.getInputNode();c.mask=a;c.setAttribute("data-inputmask",a);var b="#"+c.id;$(b).inputmask()}}},setValue:function(c,a){var d;if(a){this.clearErrorMessage(this.cst!=null)}else{d=this._validate(c);c=d.value}this._lastChg=this.valueEnter_=this.valueSel_=null;if((!d||!d.error)&&(a||!this._equalValue(this._value,c))){this._rawval=this._value=c;var b=this.getInputNode();if(b){this._defRawVal=this._lastChg=b.value=c=this.coerceToString_(c);$("#"+b.id).val(c)}}},maskTurnOn:function(){var b=this.getInputNode();if(b){var a=$("#"+b.id);if(a.hasClass("maskTurnOff")){a.val(this._rawval);a.inputmask();a.removeClass("maskTurnOff");a.addClass("maskTurnOn")}}},maskTurnOff:function(){var b=this.getInputNode();if(b){var a=$("#"+b.id);if(a.hasClass("maskTurnOn")){this._rawval=b.value;a.inputmask("remove");a.removeClass("maskTurnOn");a.addClass("maskTurnOff")}}},textAttrs_:function(){var a=this.$supers("textAttrs_",arguments);a+=' data-inputmask="'+this._mask+'"';return a},bind_:function(){this.$supers(zul.inp.Textbox,"bind_",arguments);var d=this;var b="#"+this.getInputNode().id;$.extend($.inputmask.defaults,{autoUnmask:true,definitions:{"#":{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]",cardinality:1}}});var c=$(b);c.inputmask();if(this._value){c.val(this._value)}var e=this;var a=false;if(c.hasClass("switchableFormatting")){a=otr.MaskInput.switchableFormatingDisabled}else{a=otr.MaskInput.disabled}if(!a){c.addClass("maskTurnOn");c.inputmask()}else{c.addClass("maskTurnOff");c.inputmask("remove")}c.mousedown(function(f){if(f.which==1&&$(b).hasClass("maskTurnOff")){c.inputmask();c.val(e._rawval)}});c.blur(function(f){if($(b).hasClass("maskTurnOff")){e._rawval=c.val();c.inputmask("remove")}e.doBlur_(f)});if(c.hasClass("switchableFormatting")){if(!c.hasClass("dontUsePopupMenu")){this.addPopup_(this)}}},addPopup_:function(c){var a=zk.Widget.$("$mskfmtpopup");if(!a){var b=new zul.menu.Menuitem({checkmark:true,label:"Форматировать все",title:"Форматировать все",listeners:{onClick:function(){if(otr.MaskInput.switchableFormatingDisabled){otr.MaskInput.masksTurnOn()}else{otr.MaskInput.masksTurnOff()}b.setChecked(!otr.MaskInput.switchableFormatingDisabled)}}});b.setChecked(!otr.MaskInput.switchableFormatingDisabled);a=new zul.menu.Menupopup({children:[b]});a.setId("mskfmtpopup")}this.$o().appendChild(a);zk.Widget.$(this).setContext(a)},updateChange_:function(){if(zul.inp.validating){return false}var d=this.getInputNode(),g=d.value;if(!this._reVald&&g==this._defRawVal){return false}var a=this._errmsg,h=this._validate(g);if(!h.error||h.server){var f,e;if(h.rawValue!=null){e={rawValue:h.rawValue}}else{if(!h.error){g=this.coerceToString_(h.value);if(d.value!==g){d.value=g}this._reVald=false;f=a||!this._equalValue(h.value,this._value);if(f){this._value=h.value;this._defRawVal=g}}}if(f||h.server){var b=$("#"+d.id).val()}var c=this._validate(b);this.fire("onChange",this.$class._onChangeData(this,e!=null?e:{value:this.marshall_(c.value)}),c.server?{toServer:true}:null,90)}return true}});otr.MaskInput.disabled=false;otr.MaskInput.switchableFormatingDisabled=false;otr.MaskInput.setDisabled=function(a){otr.MaskInput.disabled=a;otr.MaskInput.switchableFormatingDisabled=a};otr.MaskInput.masksTurnOn=function(){var a=$("input.zkossMaskField");a.each(function(b,c){if($(c).hasClass("switchableFormatting")){zk.Widget.$(c).maskTurnOn()}});otr.MaskInput.switchableFormatingDisabled=false};otr.MaskInput.masksTurnOff=function(){var a=$("input.zkossMaskField");a.each(function(b,c){if($(c).hasClass("switchableFormatting")){zk.Widget.$(c).maskTurnOff()}});otr.MaskInput.switchableFormatingDisabled=true};
zkreg('otr.MaskInput');
otr.AdvDecimalField=zk.$extends(zul.inp.Decimalbox,{_decimalSeparator:",",_maxIntegerDigits:16,_maxFractionDigits:2,$define:{decimalMask:function(){this.rerender()}},doFocus_:function(h){this.$supers("doFocus_",arguments);var e=this.getInputNode();var f=e.value;var a="";for(var d=0,c=f.length;d<c;d++){if(f.charAt(d).match("[\\-,0-9,"+this._decimalSeparator+"]")){a=a+f.charAt(d)}}e.value=a;var b="#"+this.getInputNode().id;var k=this._decimalSeparator;var g=this._maxFractionDigits;var l=this._maxIntegerDigits;$(b).decimalMask("-"+Array(l+1).join("9")+k+Array(g+1).join("9"))},coerceToString_:function(a){if(a!=null&&a._value=="-"){return a._value}return this.$supers("coerceToString_",arguments)}});
zkreg('otr.AdvDecimalField');
otr.AdvTextArea=zk.$extends(zul.inp.Textbox,{_insertEnter:true,_ff_disable:false,_ff_readonly:false,doKeyDown_:function(b){var e=b.keyCode;if(e==13){if(!this._insertEnter){var d=jQuery("input:visible, textarea:visible, button:visible");var c="#"+this.getInputNode().id;var a=d.index(jQuery(c));d.get(a+1).focus();b.stop()}}else{this.$supers("doKeyDown_",arguments)}},doFocus_:function(){this.$supers("doFocus_",arguments);var b=this.$n();var e=jq(b);if(!e.attr("expand")){return}var c=e.parent();this.parentStyleHeight=c.get(0).style.height;this.parentStyleWidth=c.get(0).style.width;c.outerHeight(c.outerHeight());c.outerWidth(c.outerWidth());e.addClass("expanded");e.css({top:c.offset().top+"px",left:c.offset().left+"px"});this.wasWidth=b.offsetWidth;if(!this.wasHeight){this.wasHeight=b.offsetHeight}var a=this.wasHeight>100?this.wasHeight+100:100;if(this.userHeight){a=this.userHeight}var d=this.wasWidth;if(this.userWidth){d=this.userWidth}e.animate({height:a+"px",width:d+"px"},350)},doBlur_:function(){this.$supers("doBlur_",arguments);var a=this.$n();var b=jq(a);if(!b.attr("expand")){return}this.userHeight=a.offsetHeight;this.userWidth=a.offsetWidth;b.animate({height:this.wasHeight+"px",width:this.wasWidth+"px"},500,function(){b.removeClass("expanded");b.css({top:"",left:""});var c=b.parent();c.height(this.parentStyleHeight);c.width(this.parentStyleWidth)})},onScroll_:function(){var a="#"+this.getInputNode().id;if($(a).scrollTop()+$(a).innerHeight()>=$(a).prop("scrollHeight")){zAu.send(new zk.Event(this,"onScrolledToBottom",{},{toServer:true}))}else{var b=$(a).scrollTop()==0?0:Math.round(($(a).scrollTop()+$(a).innerHeight())/$(a).prop("scrollHeight")*100);zAu.send(new zk.Event(this,"onScroll",{percent:b},{toServer:true}))}},bind_:function(){this.$supers("bind_",arguments);var a=this.$n();this.domListen_(a,"onScroll","onScroll_")},doDoubleClick_:function(){this.$supers("doDoubleClick_",arguments);var c=this.$n();var g=jq(c);if(g.attr("expand")){return}var a=g.height();var e=c.scrollHeight;var b=c.clientHeight;if(e>b){if(!g.attr("init_height")){g.attr("init_height",a)}g.height(e);var f=c.scrollHeight;for(var d=e-1;d>a;d--){g.height(d);if(c.scrollHeight>=f){e=d+5;break}f=c.scrollHeight}g.height(c.scrollHeight);setTimeout(function(){g.height(e)},100)}else{if(g.attr("init_height")){g.height(g.attr("init_height"));g.removeAttr("init_height")}}},setDisabled:function(b,a){if(!zk.ff){this.$supers("setDisabled",arguments);return}this._ff_disable=b;return this.$supers("setReadonly",[this._ff_disable||this._ff_readonly,a])},getDisabled:_zkf$=function(){if(!zk.ff){return this.$supers("getDisabled",arguments)}else{return this._ff_disable}},isDisabled:_zkf$,setReadonly:function(b,a){if(!zk.ff){return this.$supers("setReadonly",arguments)}this._ff_readonly=b;return this.$supers("setReadonly",[this._ff_disable||this._ff_readonly,a])},getReadonly:_zkf$=function(){if(!zk.ff){return this.$supers("getReadonly",arguments)}else{return this._ff_readonly}},isReadonly:_zkf$});
zkreg('otr.AdvTextArea');
otr.DraggableDocumentListitem=zk.$extends(zul.sel.Listitem,{getDragMessage_:function(){var d=this.parent,f=d._selItems,b=f.length,c=zul.sel.Listitem,e,a=2;if(!this.isSelected()||!b){return"Перемещение 1 записи"}if(!b||b<=1){return"Перещение 1 выделенной записей"}return"Перещение "+b+" выделенных записей"}});
zkreg('otr.DraggableDocumentListitem');
otr.ListNullChoiceComboBox=zk.$extends(zul.inp.Combobox,{_select:function(b,a){this.$supers("_select",arguments);this.fire("onListNullChoiceSelectItems",{items:b?[b]:[]})}});
zkreg('otr.ListNullChoiceComboBox');
otr.AdvCalendar=zk.$extends(zul.db.Calendar,{_marks:{},getMarks:function(){return this._marks},setMarks:function(a){if(this._marks!=a){this._marks=a;if(this.desktop){}}},_markCal:function(o){var f=this.getZclass(),D=this.getTime(),t=D.getMonth(),l=D.getFullYear();if(this._view=="day"){var A=D.getDate(),n=new Date(l,t,1).getDay()-zk.DOW_1ST,i=new Date(l,t+1,0).getDate(),q=new Date(l,t,0).getDate(),z=zUtl.today();if(n<0){n+=7}for(var x=0,c=-n+1;x<6;++x){var u=this.$n("w"+x);if(u!=null){for(var w=0;w<7;++w,++c){n=c<=0?q+c:c<=i?c:c-i;if(w==0&&c>i){u.style.display="none"}else{if(w==0){u.style.display=""}var g=jq(u.cells[w]),B=c<=0?-1:c<=i?0:1,p=c==A;g[0]._monofs=B;g.css("textDecoration","").removeClass(f+"-seld");if(p){g.addClass(f+"-seld");if(g.hasClass(f+"-over")){g.addClass(f+"-over-seld")}}else{g.removeClass(f+"-seld")}var a=zk.fmt.Date.formatDate(new Date(Date.UTC(l,t+B,n)),"yyyy-MM-dd");g[B?"addClass":"removeClass"]("z-outside");var e=zul.db.Renderer.disabled(this,l,t+B,n,z);g[e?"addClass":"removeClass"](f+"-disd");var r=(this._marks?this._marks[a]:false);g[r?"addClass":"removeClass"](f+"-marked");g.html(zul.db.Renderer.cellHTML(this,l,t+B,n,B)).attr("_dt",n)}}}}}else{var C=this._view=="month",b=C?"m":"y",h=C?t:l%10+1,s;for(var x=0;x<12;++x){if(s=this.$n(b+x)){jq(s)[h==x?"addClass":"removeClass"](f+"-seld")}}}var E;if((E=this.$n("a"))&&(!o||!o.silent)){_doFocus(E,o&&o.timeout)}}});
zkreg('otr.AdvCalendar');
zk.afterLoad("zul.db",function(){var a={};zk.override(zul.db.Datebox.prototype,a,{$init:function(){this.$supers(zul.db.Datebox,"$init",arguments);if(otr&&otr.CalendarInstance&&otr.CalendarInstance.isUseIndustrailCalendar()){this.afterInit(this.initIndustrialPopup)}else{this.afterInit(this.initPopup)}},initIndustrialPopup:function(){this._pop=new otr.IndustrialCalendarPopup();this._pop._marks=null;this._tm=new zul.db.CalendarTime();this.appendChild(this._pop);this.appendChild(this._tm)},initPopup:function(){this._pop=new zul.db.CalendarPop();this._tm=new zul.db.CalendarTime();this.appendChild(this._pop);this.appendChild(this._tm)}})});otr.IndustrialCalendarPopup=otr.IndustrialCalendar=zk.$extends(zul.db.CalendarPop,{that:this,_marks:{},_staticMonthYear:"",getMarks:function(){return this._marks},setMarks:function(a){if(this._marks!=a){this._marks=a;if(this.desktop){}}},getStaticMonthYear:function(){return this._marks},setStaticMonthYear:function(a){if(this._staticMonthYear!=a){this._staticMonthYear=a}},onChange:function(a){var b=this.parent;if(b&&b instanceof zul.db.Datebox){this.$super("onChange",a)}},_markCal:function(a){if(this._marks){this._markCalendar(this._marks)}else{var b=this.getTime();otr.CalendarInstance.loadData(b.getFullYear(),this)}},_loadData:function(a){this._markCalendar(a)},syncShadow:function(){var b=this.parent;if(b&&b instanceof zul.db.Datebox){var a=b.$n("pp");var c=b.getInputNode();if(a){a.style.width="auto";zk(a).position(c,"after_end")}this.$supers("syncShadow",arguments)}},open:function(b){var c=this.parent;if(c&&c instanceof zul.db.Datebox){var a=c.$n("pp");this.$supers("open",arguments)}},_markCalendar:function(x){if(this._staticMonthYear){var l=this._staticMonthYear.substr(0,this._staticMonthYear.indexOf("-"));var t=this._staticMonthYear.substr(this._staticMonthYear.indexOf("-")+1)-1;this._setTime(l,t,null,null);var A=this._node.firstChild;while(A.hasChildNodes()){A.removeChild(A.lastChild)}A.innerHTML=A.innerHTML+'<a class="z-industrialcalendar-title"><span class="z-industrialcalendar-text">'+this.getLocalizedSymbols().FMON[t]+"</span></a>"}var f=this.getZclass(),F=this.getTime(),t=F.getMonth(),l=F.getFullYear();if(this._view=="day"){var C=F.getDate(),n=new Date(l,t,1).getDay()-zk.DOW_1ST,i=new Date(l,t+1,0).getDate(),p=new Date(l,t,0).getDate(),B=zUtl.today();if(n<0){n+=7}for(var z=0,c=-n+1;z<6;++z){var u=this.$n("w"+z);if(u!=null){for(var w=0;w<7;++w,++c){n=c<=0?p+c:c<=i?c:c-i;if(w==0&&c>i){u.style.display="none"}else{if(w==0){u.style.display=""}var g=jq(u.cells[w]),D=c<=0?-1:c<=i?0:1,o=c==C;g[0]._monofs=D;g.css("textDecoration","").removeClass(f+"-seld");if(c==B.getDate()&&t==B.getMonth()&&l==B.getFullYear()){g.addClass(f+"-today")}if(o){g.addClass(f+"-seld");if(g.hasClass(f+"-over")){g.addClass(f+"-over-seld")}}else{g.removeClass(f+"-seld")}var a=zk.fmt.Date.formatDate(new Date(Date.UTC(l,t+D,n)),"yyyy-MM-dd");g[D?"addClass":"removeClass"](f+"-z-outside");var e=zul.db.Renderer.disabled(this,l,t+D,n,B);g[e?"addClass":"removeClass"](f+"-disd");var r=(x?x[a]:false);g[r&&r.search("-holiday")>-1&&!g.hasClass(f+"-weekend")&&!g.hasClass(f+"-z-outside")?"addClass":"removeClass"](f+"-marked");g[r&&r.search("-holiday")>-1&&g.hasClass(f+"-weekend")&&!g.hasClass(f+"-z-outside")?"addClass":"removeClass"](f+"-marked-weekend");g[r&&r.search("-workday")>-1&&g.hasClass(f+"-weekend")&&!g.hasClass(f+"-z-outside")?"addClass":"removeClass"](f+"-marked-moved-weekend");if(r&&r.search("-chosen")>-1&&!g.hasClass(f+"-z-outside")){g.addClass(f+"-chosen")}if(r&&r.search("-notchosen")>-1&&!g.hasClass(f+"-z-outside")){g.removeClass(f+"-chosen")}if(r&&r.search("-workday")>-1&&!g.hasClass(f+"-z-outside")&&g.hasClass(f+"-weekend")){g.removeClass(f+"-weekend")}if(r&&r.search("-waitstore")>-1&&!g.hasClass(f+"-z-outside")){g.addClass(f+"-waitstore")}g.html(zul.db.Renderer.cellHTML(this,l,t+D,n,D)).attr("_dt",n).attr("_my",this._staticMonthYear).data("value",n);if(!g.hasClass(f+"-z-outside")){g.on("click",function(){zAu.send(new zk.Event(zk.Widget.$("$industrialCalendar"),"onUpdateIndustrialDay",{date:this.getAttribute("_my")+"-"+this.getAttribute("_dt")},{toServer:true}))});g.on("contextmenu",function(){zAu.send(new zk.Event(zk.Widget.$("$industrialCalendar"),"onUpdateIndustrialDay_contextmenu",{date:this.getAttribute("_my")+"-"+this.getAttribute("_dt")},{toServer:true}));return false})}else{var q=this.$s("disabled");g.addClass(q)}}}}}}else{var E=this._view=="month",b=E?"m":"y",h=E?t:l%10+1,s;for(var z=0;z<12;++z){if(s=this.$n(b+z)){jq(s)[h==z?"addClass":"removeClass"](f+"-seld")}}}}});
zkreg('otr.IndustrialCalendar');
otr.AdvFileUpload=zk.$extends(zul.Widget,{url:"",multiple:"",maxFileSize:0,maxNumberOfFiles:0,showProgress:"",showFileList:"",totalCount:0,extensionsSet:"",isAllowedList:"true",showDropzone:"true",isScanDocumentDialog:"false",getMultiple:function(){return this.multiple},setMultiple:function(a){if(this.multiple!=a){this.multiple=a;if(a=="false"){if(this.desktop){$("#"+this.id).removeAttr("multiple")}else{$("#"+this.id).attr("multiple","")}}}},getUrl:function(){return this.url},setUrl:function(a){if(this.url!=a){this.url=a}},getMaxFileSize:function(){return this.maxFileSize},setMaxFileSize:function(a){if(this.maxFileSize!=a){this.maxFileSize=a}},getMaxNumberOfFiles:function(){return this.maxNumberOfFiles},setMaxNumberOfFiles:function(a){if(this.maxNumberOfFiles!=a){this.maxNumberOfFiles=a}},getShowProgress:function(){return this.showProgress},setShowProgress:function(a){if(this.showProgress!=a){this.showProgress=a}},getShowFileList:function(){return this.showFileList},setShowFileList:function(a){if(this.showFileList!=a){this.showFileList=a}},getShowDropzone:function(){return this.showDropzone},setShowDropzone:function(a){if(this.showDropzone!=a){this.showDropzone=a}},getIsScanDocumentDialog:function(){return this.isScanDocumentDialog},setIsScanDocumentDialog:function(a){if(this.isScanDocumentDialog!=a){this.isScanDocumentDialog=a}},getTotalCount:function(){return this.totalCount},setTotalCount:function(a){if(this.totalCount!=a){this.totalCount=a}},humanFileSize:function(a){var d=1024;if(a<d){return a+" B"}var b=["kB","MB","GB","TB","PB","EB","ZB","YB"];var c=-1;do{a/=d;++c}while(a>=d);return a.toFixed(1)+" "+b[c]},hideErrors:function(){$("#error").css("display","none").text("")},showErrors:function(a){var b=$("#error").css("display","block").text("");$.each(a,function(d,c){b.append(c+"<br/>")})},define:{},bind_:function(a){try{this.$supers("bind_",arguments);var d=this;var b=this.desktop.id;$("#fileupload").fileupload({dataType:"json",formAcceptCharset:"utf-8",sequentialUploads:true,url:d.url,add:function(i,h){var f=[];if(d.maxFileSize&&d.maxFileSize>0){$.each(h.originalFiles,function(e,j){if(j.size&&j.size>d.maxFileSize){f.push('Слишком большой файл: "'+j.name+'"')}})}if(d.isAllowedList=="true"&&d.extensionsSet&&d.extensionsSet!=""){$.each(h.originalFiles,function(j,l){var m=d.extensionsSet.split(", ");var e=1;for(var k=0;k<m.length;k++){if(l.name.toLowerCase().endsWith(m[k])){e=0;break}}if(e==1){f.push('Вложения данного типа не разрешены. Допустимы расширения: "'+d.extensionsSet+'"')}})}else{if(d.extensionsSet&&d.extensionsSet!=""){$.each(h.originalFiles,function(j,l){var m=d.extensionsSet.split(", ");var e=0;for(var k=0;k<m.length;k++){if(l.name.toLowerCase().endsWith(m[k])){e=1;break}}if(e==1){f.push('Вложения данного типа не разрешены. Запрещенные расширения: "'+d.extensionsSet+'"')}})}}if(d.maxNumberOfFiles&&d.maxNumberOfFiles>0){var g=$("#uploaded-files .button").length;if(d.showFileList!="true"){g=d.totalCount}if(g==1&&d.maxNumberOfFiles==1){zAu.send(new zk.Event(d,"onFilesClear","",{toServer:true}));$("#uploaded-files").empty()}else{if(d.maxNumberOfFiles<=g){f.push("Превышено максимальное количество загружаемых файлов")}}}if(f.length==0){h.submit();d.hideErrors();zAu.send(new zk.Event(d,"onFileAdd",h.originalFiles,{toServer:true}))}else{d.showErrors(f)}},progressall:function(h,g){if(d.showProgress=="true"){var f=parseInt(g.loaded/g.total*100,10);$("#progress .bar").css("width",f+"%")}},});$("#fileupload").fileupload({dropZone:$("#dropzone")});$("#fileupload").bind("fileuploaddone",function(i,h){var f=[];var g=[];$.each(h.result.files,function(k,l){var j=$("#uploaded-files .button").length;if(d.showFileList!="true"){j=d.totalCount}if(!d.maxNumberOfFiles||d.maxNumberOfFiles<=0||j<d.maxNumberOfFiles){var m=$("<tr/>");var e=$("<a/>",{text:"",click:function(){m.remove();d.hideErrors();zAu.send(new zk.Event(d,"onFileDelete",l,{toServer:true}))}});var o=$("<td/>");m.append(o);var n=d.maxNumberOfFiles==1?"Файл: "+l.fileName:l.fileName;o.append($("<span/>").addClass("name").text(n)).append($("<span/>").addClass("sparator").text("|"));o.append($("<span/>").addClass("filesize").text(d.humanFileSize(l.fileSize)));if(l.error){o.append($("<div/>").addClass("error").text(l.error))}else{o.append($("<div/>").addClass("button").append(e))}g.push(l);if(d.showFileList=="true"){$("#uploaded-files").append(m)}}else{f.push("Превышено максимальное количество загружаемых файлов");d.showErrors(f)}});if(d.showProgress=="true"){$("#progress .bar").css("width","0%")}zAu.send(new zk.Event(d,"onFileUpload",g,{toServer:true}))}).bind("fileuploadsubmit",function(g,f){f.formData={dtid:b,compId:d.uuid}})}catch(c){console.log(c)}},getZclass:function(){var a=this._zclass;return a?a:"z-upload"}});
zkreg('otr.AdvFileUpload');
zk._m={};
zk._m['default']=function(a){var c=(this.multiple&&this.multiple=="true")?" multiple":"";var b=this.url.length>0?this.url:"upload";a.push('<form id="fileuploadform" method="POST" enctype="multipart/form-data">');if(this.isScanDocumentDialog=="false"){if(this.showDropzone=="true"){a.push('<div id="dropzone" class="fade well">Поместите файл сюда для загрузки</div>')}a.push('<div class="btnHolder">');if(this.showDropzone=="true"){a.push('<div id="orSpan">или нажмите</div>')}a.push('<div class="fileUpload btn">');a.push("    <span>Загрузить</span>");a.push('<input id="',this.id,'" type="file" name="files[]" ',' class="upload ',this.getZclass(),'" ',c," />");a.push("</div>");a.push("</div>")}a.push('    <div id="error" class="alert alert-danger" style="display:none;"/>');if(this.showProgress=="true"){a.push('<div id="progress" class="progress">');a.push('<div class="bar" style="width: 0%;"></div>');a.push("</div>")}if(this.showFileList=="true"){if(this.maxNumberOfFiles==1){}else{a.push("<b>Файлы:</b>")}a.push('<div class="tableWrapper">');a.push('<table id="uploaded-files" class="table">');a.push("</table>");a.push("</div>")}a.push("</form>")};
;zkmld(zk._p.p.AdvFileUpload,zk._m);
(function(){otr.AdvCheckbox=zk.$extends(zul.wgt.Checkbox,{})})();
zkreg('otr.AdvCheckbox');
(function(){otr.ExCheckbox=zk.$extends(zul.wgt.Checkbox,{})})();
zkreg('otr.ExCheckbox');
otr.DocumentLinkButton=zk.$extends(zul.wgt.Button,{showDocumentLink:function(a){this.fire("onShowDocumentLinkEvent",{guid:a})}});
zkreg('otr.DocumentLinkButton');
zk.load("zul.wgt",function(){var a={};zk.override(zul.wgt.Checkbox.prototype,a,{bind_:function(h){a.bind_.apply(this,arguments);if(this.$class==zul.wgt.Checkbox||this.$class==otr.AdvCheckbox){var g=this.$n("real");if(g){g.style.position="relative";g.style.left="-9000px";var c="advcheckbox-default";if(zk.ie<8){c+=" fixinline"}jq(g).after('<div id="'+this.uuid+'-advcheckbox" class="'+c+'"></div>');var d=this.$n("advcheckbox");if(d){var f=jq(d),e=d.nextSibling,b=jq(e);if(g.checked){jq(d).addClass("advcheckbox-checked")}if(g.disabled){jq(d).addClass("advcheckbox-disabled")}f.mouseover(function(){jq(g).mouseover();if(!f.hasClass("advcheckbox-disabled")){f.addClass("advcheckbox-over")}});f.mouseout(function(){jq(g).mouseout();f.removeClass("advcheckbox-over");f.removeClass("advcheckbox-down")});f.mousedown(function(){jq(g).mousedown();if(!f.hasClass("advcheckbox-disabled")){f.addClass("advcheckbox-down")}});f.mouseup(function(){jq(g).mouseup();f.removeClass("advcheckbox-down")});f.click(function(){if(!f.hasClass("advcheckbox-disabled")){jq(g).click();if(g.checked){f.addClass("advcheckbox-checked")}else{f.removeClass("advcheckbox-checked")}}});b.mouseover(function(){if(!f.hasClass("advcheckbox-disabled")){f.addClass("advcheckbox-over")}});b.mouseout(function(){f.removeClass("advcheckbox-over");f.removeClass("advcheckbox-down")});b.mousedown(function(){if(!f.hasClass("advcheckbox-disabled")){f.addClass("advcheckbox-down")}});b.mouseup(function(){f.removeClass("advcheckbox-down")});b.click(function(){setTimeout(function(){if(g.checked){f.addClass("advcheckbox-checked")}else{f.removeClass("advcheckbox-checked")}},0)})}}}}})});
(function(){otr.AdvRadio=zk.$extends(zul.wgt.Radio,{})})();
zkreg('otr.AdvRadio');
zk.load("zul.wgt",function(){var a={};zk.override(zul.wgt.Radio.prototype,a,{bind_:function(){a.bind_.apply(this,arguments);if(this.$class==zul.wgt.Radio||this.$class==otr.AdvRadio){var f=this.$n("real");if(f){f.style.position="absolute";f.style.left="-9000px";f.style.top="-9000px";var d="advradio-default";jq(f).after('<div id="'+this.uuid+'-advradio" class="'+d+'"></div>');var c=this.$n("advradio");if(c){var g=jq(c),e=c.nextSibling,b=jq(e);if(f.checked){jq(c).addClass("advradio-checked")}if(f.disabled){jq(c).addClass("advradio-disabled")}g.mouseover(function(){jq(f).mouseover();if(!g.hasClass("advradio-disabled")){g.addClass("advradio-over")}});g.mouseout(function(){jq(f).mouseout();g.removeClass("advradio-over");g.removeClass("advradio-down")});g.mousedown(function(){jq(f).mousedown();if(!g.hasClass("advradio-disabled")){g.addClass("advradio-down")}});g.mouseup(function(){jq(f).mouseup();g.removeClass("advradio-down")});g.click(function(){if(!g.hasClass("advradio-disabled")){jq(f).click()}});b.mouseover(function(){if(!g.hasClass("advradio-disabled")){g.addClass("advradio-over")}});b.mouseout(function(){g.removeClass("advradio-over");g.removeClass("advradio-down")});b.mousedown(function(){if(!g.hasClass("advradio-disabled")){g.addClass("advradio-down")}});b.mouseup(function(){g.removeClass("advradio-down")})}}}},setChecked:_zkf=function(e){a.setChecked.apply(this,arguments);var f=this.getRadiogroup();if(f){for(var c=f.getItems(),d=c.length;d--;){var b=c[d].$n("advradio");if(c[d].isChecked()){jq(b).addClass("advradio-checked")}else{jq(b).removeClass("advradio-checked")}}}},getName:function(){try{var b=this.getRadiogroup();return null!=b?b.getName():this.uuid}catch(c){console.log(c);return this.uuid}},setDisabled:function(d){a.setDisabled.apply(this,arguments);var c=this.$n("real");var b=this.$n("advradio");if(c&&b){if(c.disabled){jq(b).addClass("advradio-disabled")}else{jq(b).removeClass("advradio-disabled")}}},setSelected:_zkf})});
otr.Treecol=zk.$extends(zul.sel.Treecol,{},{_aftersizing:function(g,m){var r=g.control,q=r.getMeshWidget(),d=jq.px(g._zszofs),c=q.ehdfaker,h=q.ebdfaker,n=q.eftfaker,p=zk(r.$n()).cellIndex();var o=c.childNodes,b=h.childNodes;var a=[];for(var l=q.head.firstChild,e=0;l;l=l.nextSibling,e++){var k=o[e].style.width,f=l._width,j=k&&k.indexOf("%")<0;if(f){l._width=a[e]=f}else{l._width=a[e]=j?k:jq.px0(l.$n().offsetWidth)}if(!j){o[e].style.width=b[e].style.width=l._width}}if(!r.origWd){r._width=a[p]=d}o[p].style.width=b[p].style.width=d;q.eheadtbl.width="";q.ebodytbl.width="";if(q.efoottbl){q.efoottbl.width=""}delete q._span;delete q._sizedByContent;for(var l=q.head.firstChild;l;l=l.nextSibling){l.setHflex_(null)}r.parent.fire("onColSize",zk.copy({index:p,column:r,width:d,widths:a},m.data),null,0);q.$n()._lastsz=null;if(!zk.webkit){q.eheadtbl.width="100%";q.ebodytbl.width="100%";if(q.efoottbl){q.efoottbl.width="100%"}}zUtl.fireSized(q,-1)}});
zkreg('otr.Treecol');
var _Cwgt2={};zk.override(zul.db.CalendarPop.prototype,_Cwgt2,{syncShadow:function(){var b=this.parent,a=b.$n("pp");var c=b.getInputNode();if(a){a.style.width="auto";zk(a).position(c,"after_end")}_Cwgt2.syncShadow.apply(this,arguments)},open:function(b){var c=this.parent,a=c.$n("pp");_Cwgt2.open.apply(this,arguments)}});
zk.load("zul.box",function(){var a={};zk.override(zul.box.Layout.prototype,a,{onChildAdded_:function(c){try{a.onChildAdded_.apply(this,arguments)}catch(b){}}})});
zAu.cmd0.showPointerPopup=function(j,b,f,g,e,d,i,c,a,k){var h=(otr)?otr.PointerPopupWindow:null;if(h){h.show(b,e,{ref:d,pos:i,off:c,dur:a,type:g,closable:k,title:j,desc:f})}else{jq.alert(b)}};(function(){var b={warning:"z-icon-exclamation-circle",info:"z-icon-info-circle",error:"z-icon-times-circle"};var a={u:"up",d:"down",l:"left",r:"right"};otr.PointerPopupWindow=zk.$extends(zul.wgt.Notification,{$init:function(d,c){this.$supers(zul.wgt.Notification,"$init",arguments);this._title=c.title;this._desc=c.desc;this._msg=d;this._type=c.type;this._ref=c.ref;this._dur=c.dur;this._closable=c.closable},redraw:function(c){var e=this.uuid,d=this.$s("icon");c.push("<div",this.domAttrs_(),">");if(this._ref){c.push('<div id="',e,'-p" class="',this.$s("pointer"),'"></div>')}c.push('<div id="',e,'-cave" class="',this.$s("content"),'">');c.push('<div id="',e,'-title-cave" class="',this.$s("title"),'">');c.push('<div id="',e,'-title-image-cave" class="',this.$s(this._type+"-image"),'">&nbsp;</div>');c.push('<div id="',e,'-title-text-cave" class="',this.$s("title-text"),'">',this._msg,"</div>");c.push("</div>");c.push('<div id="',e,'-msg-cave" class="',this.$s("msg"),'">',this._msg,"</div>");c.push('<div id="',e,'-desc-cave" class="',this.$s("desc"),'">',this._desc,"</div>");c.push("</div>");if(this._closable){c.push('<div id="',e,'-cls" class="',this.$s("close"),'"><i id="',e,'-clsIcon" class="',d,' z-icon-times"></i></div>')}c.push("</div>")}},{show:function(i,c,g){if(!g){g={}}var e=zk.Widget.$(c),f=g.ref,j=g.pos,d=g.dur,h=g.title;desc=g.desc;ntf=new otr.PointerPopupWindow(i,g),off=g.off;if(!j&&!off){j=f?"end_center":"middle_center"}if(!e){e=zk.Desktop.$().firstChild}e.appendChild(ntf);ntf.open(f,off,j);if(d>0){setTimeout(function(){if(ntf.desktop){ntf.close()}},d)}}})})();
zkreg('otr.PointerPopupWindow');
otr.IteratorListbox=zk.$extends(zul.sel.Listbox,{_afterCalcSize:function(){this.$supers("_afterCalcSize",arguments);var b=this._isAllWidths();if(b){var a=this.eheadtbl;if(a&&a.style.width){if(this.paging){this.paging.setWidth(a.style.width)}this.fire("onIteratorSize",{width:a.style.width},{toServer:true})}}}});
zkreg('otr.IteratorListbox');
otr.Actionbar=zk.$extends(zul.wgt.Div,{bind_:function(){this.$supers("bind_",arguments);zk(this.$n()).disableSelection();zWatch.listen({onSize:this,beforeSize:this});this.recalc();this.scrollEvent=false},unbind_:function(){zWatch.unlisten({onSize:this,beforeSize:this});this.$supers("unbind_",arguments)},beforeSize:zk.ie6_?function(){jq(this.$n("body")).css("width","").removeClass("actionbar-body-scroll")}:zk.$void,onSize:function(){if(this.scrollEvent===false){this._addScollEvent();this.scrollEvent=true}this.recalc();var c=jq(this.$n("left"));var a=jq(this.$n("right"));var e=jq(this.$n("body"));var d=this.$n("cave");var b=this.$n().offsetWidth;if(b<this.childWidth){c.addClass("actionbar-left-scroll");a.addClass("actionbar-right-scroll");e.addClass("actionbar-body-scroll").width(jq.px0(b-zk(this.$n("body")).sumStyles("lr",jq.margins)));d.distance=e.width()-this.childWidth}else{c.removeClass("actionbar-left-scroll");a.removeClass("actionbar-right-scroll");e.removeClass("actionbar-body-scroll").width(jq.px0(b));d.style.marginLeft="0px"}},_addScollEvent:function(){var c=this.$n("cave"),b=jq(c),a=function(){b.stop(true)};jq(this.$n("left")).mouseover(function(){b.animate({marginLeft:"0px"},Math.abs(zk.parseInt(b.css("marginLeft"))/80)*400)}).mouseout(a);jq(this.$n("right")).mouseover(function(){b.animate({marginLeft:c.distance+"px"},Math.abs((c.distance-zk.parseInt(b.css("marginLeft")))/80)*400)}).mouseout(a)},recalc:_zkf=function(){if(!this.desktop){return}var a=0,c=this.$n("cave"),b=jq(c);b.children().each(function(){jq(this).children().each(function(){a+=jq(this).width()})});this.childWidth=a},onChildAdded_:_zkf,onChildRemoved_:_zkf,redraw:function(b){var c=this.uuid;b.push("<div",this.domAttrs_(),">",'<div id="',c,'-right"></div>','<div id="',c,'-left"></div>','<div id="',c,'-body" class="',this.getZclass(),'-body">','<div id="',c,'-cave" style="width:100%;">');for(var a=this.firstChild;a;a=a.nextSibling){a.redraw(b)}b.push('<div class="z-clear"></div></div></div></div>')}});
zkreg('otr.Actionbar');
(function(){var a={};var b="oldValue";var c=function(g,e,d){var f=e.filter(function(h){return !/chf-(.)*/i.test(h)});f=f.concat(d);g.setSclass(f.join(" "))};zk.override(zul.inp.InputWidget.prototype,a,{$init:function(d){var e=this;this.$supers("$init",d);this.setListener("onChange",function(){setTimeout(function(){if(e.get(b)||jq(e).attr(b)){e.markChanged()}},600)});this.setListener("onHistoryView",function(){if(e.get(b)||jq(e).attr(b)){e.markChanged()}})},markChanged:function(){var d=this.get(b)||jq(this).attr(b);var e=this.getValue();var f=this.getSclass()?this.getSclass().split(" "):[];if(d&&d==e){delete f[f.indexOf("chf-addedHighlight")];delete f[f.indexOf("chf-deletedHighlight")];delete f[f.indexOf("chf-changedHighlight")];this.setSclass(f.join(" "))}else{if((!d||d=="null")&&e){c(this,f,"chf-addedHighlight")}else{if((d&&d!="null")&&!e){c(this,f,"chf-deletedHighlight")}else{if(d&&d!="null"&&e&&e!="null"){if(e instanceof Date){e=e.toLocaleDateString();d=new Date(d).toLocaleDateString()}if(d!=e){c(this,f,"chf-changedHighlight")}}}}}}})}());
if(zk.ie10){zk.afterLoad("zul.db",function(){zul.db.DateboxCtrl.isPreservedFocus=function(a){return a.widgetName=="calendar"?true:false}});zk.afterLoad("zul.inp",function(){zul.inp.InputCtrl.isPreservedFocus=function(a){return a.widgetName=="combobox"?false:true}})};
otr.DynamicChosenbox=zk.$extends(zkmax.inp.Chosenbox,{selectSubModel:function(a){zAu.send(new zk.Event(this,"onSelectSubModel",{text:a,select:true},{toServer:true}))},deselectSubModel:function(a){zAu.send(new zk.Event(this,"onSelectSubModel",{text:a,select:false},{toServer:true}))},_doDeselect:function(a,i){var b=jq(a).find("."+this.$s("item-content"))[0].innerHTML,j=this._getItemByValue(b),l=this._selItems,k=l.indexOf(b);if(this._open){this.setOpen(false,{sendOnOpen:true})}l.splice(k,1);if(j){j.style.display="block"}jq(a).remove();this._updatePopupPosition();if(i&&i.sendOnSelect){if(!this._renderByServer){this.fireOnSelect()}else{this.deselectSubModel(b)}}this._startFixDisplay()},_doSelect:function(a,f){this._hliteOpt(a,false);var b=a.innerHTML;if(this._selItems.indexOf(b)==-1){a.style.display="none";this._selItems.push(b);this._fixEmptyMessage(true);if(f&&f.sendOnSelect){if(!this._renderByServer){this.fireOnSelect()}else{this.selectSubModel(b)}}}},_fireOnSearching:function(a){var b={text:a};this.fire("onSearching",b)},_fixSelDisplay:function(s,v,t){var C=this.$n("pp"),a=jq(C),z=this._ppMaxHeight,D=C.style,u=this._selItems,b=jq(this.$n("sel")).children(),r=false,w=false,x,y,B,A;v=v?v.trim():"";B=v&&v==this._emptyMessage||v=="";for(x=0,y=b[x];x<b.length;x++,y=b[x]){A=u.indexOf(y.innerHTML)!=-1;if(t||!A){if(!A&&(B||this._renderByServer||v)){if(!r){r=true;if(s){this._hliteOpt(y,true)}}y.style.display="block"}else{this._hliteOpt(y,false);y.style.display="none"}}if(!w&&v){w=true}}D.height="auto";if(a.height()>z){D.height=z+"px"}return{_found:r,_exist:w}}});
zkreg('otr.DynamicChosenbox');
otr.AdvAuxhead=zk.$extends(zul.mesh.Auxhead,{});
zkreg('otr.AdvAuxhead');
otr.AdvAuxheader=zk.$extends(zul.mesh.Auxheader,{$define:{fromIdx:null,toIdx:null},domAttrs_:function(){var a=this.$supers("domAttrs_",arguments);return a+' fromIdx="'+this._fromIdx+'" toIdx="'+this._toIdx+'"'}},{_aftersizing:function(A,t){var l=A.control,b=l.getMeshWidget(),k=jq.px(A._zszofs),s=b.ehdfaker,p=b.ebdfaker,f=b.eftfaker,a=l.getFromIdx(),C=l.getToIdx(),j;if(C&&C>=0){j=l.getToIdx()}else{j=zk(l.$n()).cellIndex()}var B=s.childNodes,d=p.childNodes,r=f?f.childNodes:null;var m=[];for(var q=b.head.firstChild,y=0;q;q=q.nextSibling,y++){var h=B[y].style.width,c=q._origWd,g=h&&h.indexOf("%")<0;if(c){if(g&&zk.parseFloat(h)>1){c=h}q._width=m[y]=c}else{m[y]=g?h:jq.px0(q.$n().offsetWidth);if(q.isVisible()){q._width=m[y]}}if(!g){B[y].style.width=d[y].style.width=m[y];if(r){r[y].style.width=m[y]}}var x=zk.parseInt(m[y]);if(q._hflexWidth){q.setHflex_(null);q._hflexWidth=undefined}if(b._minWd){b._minWd.wds[y]=x}}var e=0;for(var y=a;y<C;y++){var u=B[y],z=zk.Widget.$(u),v=z&&z.isVisible();if(v){e+=zk.parseInt(m[y])}}if(e>0){var o=zk.parseInt(k);o-=e;k=jq.px(o)}if(!l.origWd){l._width=m[j]=k}B[j].style.width=d[j].style.width=k;if(r){r[j].style.width=k}b.eheadtbl.width="";b.ebodytbl.width="";if(b.efoottbl){b.efoottbl.width=""}delete b._span;delete b._sizedByContent;for(var q=b.head.firstChild;q;q=q.nextSibling){q.setHflex_(null)}l.parent.fire("onColSize",zk.copy({index:j,column:l,width:k,widths:m},t.data),null,0);b.$n()._lastsz=null;if(!zk.webkit){b.eheadtbl.width="100%";b.ebodytbl.width="100%";if(b.efoottbl){b.efoottbl.width="100%"}}zUtl.fireSized(b,-1)}});
zkreg('otr.AdvAuxheader');
zk.load("zul.inp",function(){var c={};function a(d,f,e){d.removeClass();d.addClass(f);if(e){d.addClass(e)}}var b;zk.override(zul.inp.Combobox.prototype,c,{open:function(e){var g="#"+this.uuid+"-pp";a(jq(g),this.$s("popup"),this.getSclass());c.open.apply(this,arguments);if(zk.ie10){jq(g).focus()}var d=this.uuid+"-pp";var f=this.uuid+"-btn";b=function(l){if(l.srcElement==null||$(l.srcElement).length<1){return}var i=$(l.srcElement)[0].id;var h=document.getElementById(i);var k=document.getElementById(d);var j=document.getElementById(f).firstElementChild;if(k!=null&&j!=null&&!k.contains(h)){$(j).click();document.removeEventListener("wheel",b,false);b=null}};document.addEventListener("wheel",b,false)},doBlur_:function(d){this.$supers("doBlur_",arguments);if(zk.currentFocus==null){this.close()}if(b!=null){document.removeEventListener("wheel",b,false);b=null}}})});
zk.load("zul.wgt",function(){var a={};zk.override(zul.wgt.Groupbox.prototype,a,{_redrawCave:function(c,e){c.push('<div id="',this.uuid,'-cave"',this._contentAttrs(),">");for(var b=this.firstChild,d=this.caption;b;b=b.nextSibling){if(b!=d){b.redraw(c)}}c.push("</div>")},fixCollapsedWidth:function(){if(this.isOpen()){return}var d=this.$n("cave");if(d){var b=jq(d).width();if(b==0){b=jq(d.parentNode).width()}else{b=jq(d).outerWidth()}b=jq.px(b);jq(this)[0].style.minWidth=b;var c=jq(this)[0].parentNode;if(c){c.style.minWidth=b}}}})});
zk.load("zul.db",function(){var a={};zk.override(zul.db.Datebox.prototype,a,{_markError:function(f,e,d){this._errmsg=f;if(this.desktop){jq(this.getInputNode()).addClass(this.$s("invalid"));var b=this._cst,c;if(b!="[c"){if(b&&(c=b.showCustomError)){c=c.call(b,this,f)}}if(!d){this.fire("onError",{value:e,message:f})}}},coerceFromString_:function(i,f){var b=a._unformater,j=this.getTimeZone();if(b&&jq.isFunction(b)){var e=b(i);if(e){this._shortcut=i;return e}}if(i){var c=this._value?Dates.newInstance(this._value):null,g=this.getFormat(),h=new zk.fmt.Calendar().parseDate(i,f||g,!this._lenient,c,this._localizedSymbols,j);if(!h){return{error:zk.fmt.Text.format(msgzul.DATE_REQUIRED+(this.localizedFormat.replace(_quotePattern,"")))}}if(!g.match(/[HkKh]/)){h=new zk.fmt.Calendar().escapeDSTConflict(h,j)}return h}return null},onChange:function(i){var e=this.getTime(),k=this.parent,c=k.getTimeFormat(),f=k.getValue(),h=k.isReadonly(),g=k.getTimeZone(),b=new zk.fmt.Calendar();if(c){var j=k._tm,d=j.getValue();if(c.match(/[HK]/i)){e.setHours(d.getHours())}if(c.match(/[m]/)){e.setMinutes(d.getMinutes())}if(c.match(/[s]/)){e.setSeconds(d.getSeconds())}if(c.match(/[S]/)){e.setMilliseconds(d.getMilliseconds())}if(!c.match(/[HkKh]/)){e=b.escapeDSTConflict(e,g)}}else{if(f){e=Dates.newInstance([e.getFullYear(),e.getMonth(),e.getDate(),f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds()],g);if(!this.getFormat().match(/[HkKh]/)){e=b.escapeDSTConflict(e,g)}}}if(!i.data.shiftView){k.getInputNode().value=k.coerceToString_(e)}if(this._view=="day"&&i.data.shallClose!==false){this.close();i.data.value=e;if(!this.$class._equalDate(e,f)){k._value=e;k.updateChange_()}}i.stop()}})});
msgzul.OUT_OF_RANGE="Не вписывается в диапазон ";
zk.load("zul.inp",function(){var a={};zk.override(zul.inp.Bandpopup.prototype,a,{fixPopupHeight:function(){var j=this.$n(),e=j.offsetTop,c=j.children,h=j.offsetParent.offsetTop,f=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,g=0;for(var d=0;d<c.length;d++){g+=$(c[d]).height()}var b=h+e+g-f;if(b<0){b=0}this.setHeight(jq.px0(g-b))}})});

}finally{zk.setLoaded(zk._p.n);}});zk.setLoaded('otr',1);